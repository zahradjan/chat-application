{"ast":null,"code":"import IpfsPubsubPeerMonitor from \"ipfs-pubsub-peer-monitor\";\nimport { makeAutoObservable, runInAction, toJS } from \"mobx\";\nexport class ChannelStore {\n  constructor(rootStore) {\n    this.rootStore = rootStore;\n    this.room = undefined;\n    this.chatRoomMessagesDb = undefined;\n    this.chatRoomMessages = [];\n    makeAutoObservable(this);\n  }\n\n  async init(topic) {\n    if (this.rootStore.dataStore.ipfsNode === undefined) throw Error(\"IPFS Node not defined!\");\n    if (this.rootStore.dataStore.orbitDb === undefined) throw Error(\"OrbitDb not defined!\");\n    this.room = new IpfsPubsubPeerMonitor(this.rootStore.ipfsNode.pubsub, topic);\n  }\n\n  async listenForJoinedPeers() {\n    this.room.on(\"join\", async peerJoined => {\n      console.log(\"Peer joined: \" + peerJoined);\n      console.log(`Peers on Pubsub ${this.roomName}: ` + (await this.room.getPeers()));\n    });\n  }\n\n  async listenForLeftPeers() {\n    this.room.on(\"leave\", async peerLeft => {\n      console.log(\"Peer left: \" + peerLeft);\n    });\n  }\n\n}","map":{"version":3,"names":["IpfsPubsubPeerMonitor","makeAutoObservable","runInAction","toJS","ChannelStore","constructor","rootStore","room","undefined","chatRoomMessagesDb","chatRoomMessages","init","topic","dataStore","ipfsNode","Error","orbitDb","pubsub","listenForJoinedPeers","on","peerJoined","console","log","roomName","getPeers","listenForLeftPeers","peerLeft"],"sources":["C:/Users/zajan/GitHub/chatApplication/src/data/store/ChannelStore.js"],"sourcesContent":["import IpfsPubsubPeerMonitor from \"ipfs-pubsub-peer-monitor\";\r\nimport { makeAutoObservable, runInAction, toJS } from \"mobx\";\r\n\r\nexport class ChannelStore {\r\n  room;\r\n  roomName;\r\n  chatRoomMessagesDb;\r\n  chatRoomMessages;\r\n  constructor(rootStore) {\r\n    this.rootStore = rootStore;\r\n    this.room = undefined;\r\n    this.chatRoomMessagesDb = undefined;\r\n    this.chatRoomMessages = [];\r\n    makeAutoObservable(this);\r\n  }\r\n  async init(topic) {\r\n    if (this.rootStore.dataStore.ipfsNode === undefined) throw Error(\"IPFS Node not defined!\");\r\n    if (this.rootStore.dataStore.orbitDb === undefined) throw Error(\"OrbitDb not defined!\");\r\n    this.room = new IpfsPubsubPeerMonitor(this.rootStore.ipfsNode.pubsub, topic);\r\n  }\r\n  async listenForJoinedPeers() {\r\n    this.room.on(\"join\", async (peerJoined) => {\r\n      console.log(\"Peer joined: \" + peerJoined);\r\n      console.log(`Peers on Pubsub ${this.roomName}: ` + (await this.room.getPeers()));\r\n    });\r\n  }\r\n  async listenForLeftPeers() {\r\n    this.room.on(\"leave\", async (peerLeft) => {\r\n      console.log(\"Peer left: \" + peerLeft);\r\n    });\r\n  }\r\n}\r\n"],"mappings":"AAAA,OAAOA,qBAAP,MAAkC,0BAAlC;AACA,SAASC,kBAAT,EAA6BC,WAA7B,EAA0CC,IAA1C,QAAsD,MAAtD;AAEA,OAAO,MAAMC,YAAN,CAAmB;EAKxBC,WAAW,CAACC,SAAD,EAAY;IACrB,KAAKA,SAAL,GAAiBA,SAAjB;IACA,KAAKC,IAAL,GAAYC,SAAZ;IACA,KAAKC,kBAAL,GAA0BD,SAA1B;IACA,KAAKE,gBAAL,GAAwB,EAAxB;IACAT,kBAAkB,CAAC,IAAD,CAAlB;EACD;;EACS,MAAJU,IAAI,CAACC,KAAD,EAAQ;IAChB,IAAI,KAAKN,SAAL,CAAeO,SAAf,CAAyBC,QAAzB,KAAsCN,SAA1C,EAAqD,MAAMO,KAAK,CAAC,wBAAD,CAAX;IACrD,IAAI,KAAKT,SAAL,CAAeO,SAAf,CAAyBG,OAAzB,KAAqCR,SAAzC,EAAoD,MAAMO,KAAK,CAAC,sBAAD,CAAX;IACpD,KAAKR,IAAL,GAAY,IAAIP,qBAAJ,CAA0B,KAAKM,SAAL,CAAeQ,QAAf,CAAwBG,MAAlD,EAA0DL,KAA1D,CAAZ;EACD;;EACyB,MAApBM,oBAAoB,GAAG;IAC3B,KAAKX,IAAL,CAAUY,EAAV,CAAa,MAAb,EAAqB,MAAOC,UAAP,IAAsB;MACzCC,OAAO,CAACC,GAAR,CAAY,kBAAkBF,UAA9B;MACAC,OAAO,CAACC,GAAR,CAAa,mBAAkB,KAAKC,QAAS,IAAjC,IAAwC,MAAM,KAAKhB,IAAL,CAAUiB,QAAV,EAA9C,CAAZ;IACD,CAHD;EAID;;EACuB,MAAlBC,kBAAkB,GAAG;IACzB,KAAKlB,IAAL,CAAUY,EAAV,CAAa,OAAb,EAAsB,MAAOO,QAAP,IAAoB;MACxCL,OAAO,CAACC,GAAR,CAAY,gBAAgBI,QAA5B;IACD,CAFD;EAGD;;AA3BuB"},"metadata":{},"sourceType":"module"}