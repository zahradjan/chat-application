{"ast":null,"code":"'use strict';\n\nconst AggregateError = require('aggregate-error');\n\nconst PCancelable = require('p-cancelable');\n\nclass FilterError extends Error {}\n\nconst pSome = (iterable, options) => new PCancelable((resolve, reject, onCancel) => {\n  const {\n    count,\n    filter = () => true\n  } = options;\n\n  if (!Number.isFinite(count)) {\n    reject(new TypeError(`Expected a finite number, got ${typeof options.count}`));\n    return;\n  }\n\n  const values = [];\n  const errors = [];\n  let elementCount = 0;\n  let isSettled = false;\n  const completed = new Set();\n\n  const maybeSettle = () => {\n    if (values.length === count) {\n      resolve(values);\n      isSettled = true;\n    }\n\n    if (elementCount - errors.length < count) {\n      reject(new AggregateError(errors));\n      isSettled = true;\n    }\n\n    return isSettled;\n  };\n\n  const cancelPending = () => {\n    for (const promise of iterable) {\n      if (!completed.has(promise) && typeof promise.cancel === 'function') {\n        promise.cancel();\n      }\n    }\n  };\n\n  onCancel(cancelPending);\n\n  for (const element of iterable) {\n    elementCount++;\n\n    (async () => {\n      try {\n        const value = await element;\n\n        if (isSettled) {\n          return;\n        }\n\n        if (!filter(value)) {\n          throw new FilterError('Value does not satisfy filter');\n        }\n\n        values.push(value);\n      } catch (error) {\n        errors.push(error);\n      } finally {\n        completed.add(element);\n\n        if (!isSettled && maybeSettle()) {\n          cancelPending();\n        }\n      }\n    })();\n  }\n\n  if (count > elementCount) {\n    reject(new RangeError(`Expected input to contain at least ${options.count} items, but contains ${elementCount} items`));\n    cancelPending();\n  }\n});\n\nmodule.exports = pSome;\nmodule.exports.AggregateError = AggregateError;\nmodule.exports.FilterError = FilterError;","map":{"version":3,"names":["AggregateError","require","PCancelable","FilterError","Error","pSome","iterable","options","resolve","reject","onCancel","count","filter","Number","isFinite","TypeError","values","errors","elementCount","isSettled","completed","Set","maybeSettle","length","cancelPending","promise","has","cancel","element","value","push","error","add","RangeError","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/p-some/index.js"],"sourcesContent":["'use strict';\nconst AggregateError = require('aggregate-error');\nconst PCancelable = require('p-cancelable');\n\nclass FilterError extends Error { }\n\nconst pSome = (iterable, options) => new PCancelable((resolve, reject, onCancel) => {\n\tconst {\n\t\tcount,\n\t\tfilter = () => true\n\t} = options;\n\n\tif (!Number.isFinite(count)) {\n\t\treject(new TypeError(`Expected a finite number, got ${typeof options.count}`));\n\t\treturn;\n\t}\n\n\tconst values = [];\n\tconst errors = [];\n\tlet elementCount = 0;\n\tlet isSettled = false;\n\n\tconst completed = new Set();\n\tconst maybeSettle = () => {\n\t\tif (values.length === count) {\n\t\t\tresolve(values);\n\t\t\tisSettled = true;\n\t\t}\n\n\t\tif (elementCount - errors.length < count) {\n\t\t\treject(new AggregateError(errors));\n\t\t\tisSettled = true;\n\t\t}\n\n\t\treturn isSettled;\n\t};\n\n\tconst cancelPending = () => {\n\t\tfor (const promise of iterable) {\n\t\t\tif (!completed.has(promise) && typeof promise.cancel === 'function') {\n\t\t\t\tpromise.cancel();\n\t\t\t}\n\t\t}\n\t};\n\n\tonCancel(cancelPending);\n\n\tfor (const element of iterable) {\n\t\telementCount++;\n\n\t\t(async () => {\n\t\t\ttry {\n\t\t\t\tconst value = await element;\n\n\t\t\t\tif (isSettled) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!filter(value)) {\n\t\t\t\t\tthrow new FilterError('Value does not satisfy filter');\n\t\t\t\t}\n\n\t\t\t\tvalues.push(value);\n\t\t\t} catch (error) {\n\t\t\t\terrors.push(error);\n\t\t\t} finally {\n\t\t\t\tcompleted.add(element);\n\n\t\t\t\tif (!isSettled && maybeSettle()) {\n\t\t\t\t\tcancelPending();\n\t\t\t\t}\n\t\t\t}\n\t\t})();\n\t}\n\n\tif (count > elementCount) {\n\t\treject(new RangeError(`Expected input to contain at least ${options.count} items, but contains ${elementCount} items`));\n\t\tcancelPending();\n\t}\n});\n\nmodule.exports = pSome;\nmodule.exports.AggregateError = AggregateError;\nmodule.exports.FilterError = FilterError;\n"],"mappings":"AAAA;;AACA,MAAMA,cAAc,GAAGC,OAAO,CAAC,iBAAD,CAA9B;;AACA,MAAMC,WAAW,GAAGD,OAAO,CAAC,cAAD,CAA3B;;AAEA,MAAME,WAAN,SAA0BC,KAA1B,CAAgC;;AAEhC,MAAMC,KAAK,GAAG,CAACC,QAAD,EAAWC,OAAX,KAAuB,IAAIL,WAAJ,CAAgB,CAACM,OAAD,EAAUC,MAAV,EAAkBC,QAAlB,KAA+B;EACnF,MAAM;IACLC,KADK;IAELC,MAAM,GAAG,MAAM;EAFV,IAGFL,OAHJ;;EAKA,IAAI,CAACM,MAAM,CAACC,QAAP,CAAgBH,KAAhB,CAAL,EAA6B;IAC5BF,MAAM,CAAC,IAAIM,SAAJ,CAAe,iCAAgC,OAAOR,OAAO,CAACI,KAAM,EAApE,CAAD,CAAN;IACA;EACA;;EAED,MAAMK,MAAM,GAAG,EAAf;EACA,MAAMC,MAAM,GAAG,EAAf;EACA,IAAIC,YAAY,GAAG,CAAnB;EACA,IAAIC,SAAS,GAAG,KAAhB;EAEA,MAAMC,SAAS,GAAG,IAAIC,GAAJ,EAAlB;;EACA,MAAMC,WAAW,GAAG,MAAM;IACzB,IAAIN,MAAM,CAACO,MAAP,KAAkBZ,KAAtB,EAA6B;MAC5BH,OAAO,CAACQ,MAAD,CAAP;MACAG,SAAS,GAAG,IAAZ;IACA;;IAED,IAAID,YAAY,GAAGD,MAAM,CAACM,MAAtB,GAA+BZ,KAAnC,EAA0C;MACzCF,MAAM,CAAC,IAAIT,cAAJ,CAAmBiB,MAAnB,CAAD,CAAN;MACAE,SAAS,GAAG,IAAZ;IACA;;IAED,OAAOA,SAAP;EACA,CAZD;;EAcA,MAAMK,aAAa,GAAG,MAAM;IAC3B,KAAK,MAAMC,OAAX,IAAsBnB,QAAtB,EAAgC;MAC/B,IAAI,CAACc,SAAS,CAACM,GAAV,CAAcD,OAAd,CAAD,IAA2B,OAAOA,OAAO,CAACE,MAAf,KAA0B,UAAzD,EAAqE;QACpEF,OAAO,CAACE,MAAR;MACA;IACD;EACD,CAND;;EAQAjB,QAAQ,CAACc,aAAD,CAAR;;EAEA,KAAK,MAAMI,OAAX,IAAsBtB,QAAtB,EAAgC;IAC/BY,YAAY;;IAEZ,CAAC,YAAY;MACZ,IAAI;QACH,MAAMW,KAAK,GAAG,MAAMD,OAApB;;QAEA,IAAIT,SAAJ,EAAe;UACd;QACA;;QAED,IAAI,CAACP,MAAM,CAACiB,KAAD,CAAX,EAAoB;UACnB,MAAM,IAAI1B,WAAJ,CAAgB,+BAAhB,CAAN;QACA;;QAEDa,MAAM,CAACc,IAAP,CAAYD,KAAZ;MACA,CAZD,CAYE,OAAOE,KAAP,EAAc;QACfd,MAAM,CAACa,IAAP,CAAYC,KAAZ;MACA,CAdD,SAcU;QACTX,SAAS,CAACY,GAAV,CAAcJ,OAAd;;QAEA,IAAI,CAACT,SAAD,IAAcG,WAAW,EAA7B,EAAiC;UAChCE,aAAa;QACb;MACD;IACD,CAtBD;EAuBA;;EAED,IAAIb,KAAK,GAAGO,YAAZ,EAA0B;IACzBT,MAAM,CAAC,IAAIwB,UAAJ,CAAgB,sCAAqC1B,OAAO,CAACI,KAAM,wBAAuBO,YAAa,QAAvG,CAAD,CAAN;IACAM,aAAa;EACb;AACD,CAzEoC,CAArC;;AA2EAU,MAAM,CAACC,OAAP,GAAiB9B,KAAjB;AACA6B,MAAM,CAACC,OAAP,CAAenC,cAAf,GAAgCA,cAAhC;AACAkC,MAAM,CAACC,OAAP,CAAehC,WAAf,GAA6BA,WAA7B"},"metadata":{},"sourceType":"script"}