{"ast":null,"code":"const {\n  Buffer\n} = require('buffer');\n\nconst alloc = Buffer.alloc;\nconst ZEROS = '0000000000000000000';\nconst SEVENS = '7777777777777777777';\nconst ZERO_OFFSET = '0'.charCodeAt(0);\nconst USTAR_MAGIC = Buffer.from('ustar\\x00', 'binary');\nconst USTAR_VER = Buffer.from('00', 'binary');\nconst MASK = parseInt('7777', 8);\nconst MAGIC_OFFSET = 257;\nconst VERSION_OFFSET = 263;\n\nconst toTypeflag = function (flag) {\n  switch (flag) {\n    case 'file':\n      return 0;\n\n    case 'link':\n      return 1;\n\n    case 'symlink':\n      return 2;\n\n    case 'character-device':\n      return 3;\n\n    case 'block-device':\n      return 4;\n\n    case 'directory':\n      return 5;\n\n    case 'fifo':\n      return 6;\n\n    case 'contiguous-file':\n      return 7;\n\n    case 'pax-header':\n      return 72;\n  }\n\n  return 0;\n};\n\nconst cksum = function (block) {\n  let sum = 8 * 32;\n\n  for (let i = 0; i < 148; i++) sum += block[i];\n\n  for (let j = 156; j < 512; j++) sum += block[j];\n\n  return sum;\n};\n\nconst encodeOct = function (val, n) {\n  val = val.toString(8);\n  if (val.length > n) return SEVENS.slice(0, n) + ' ';else return ZEROS.slice(0, n - val.length) + val + ' ';\n};\n\nconst addLength = function (str) {\n  const len = Buffer.byteLength(str);\n  let digits = Math.floor(Math.log(len) / Math.log(10)) + 1;\n  if (len + digits >= Math.pow(10, digits)) digits++;\n  return len + digits + str;\n};\n\nexports.encodePax = function (opts) {\n  // TODO: encode more stuff in pax\n  let result = '';\n  if (opts.name) result += addLength(' path=' + opts.name + '\\n');\n  if (opts.linkname) result += addLength(' linkpath=' + opts.linkname + '\\n');\n  const pax = opts.pax;\n\n  if (pax) {\n    for (const key in pax) {\n      result += addLength(' ' + key + '=' + pax[key] + '\\n');\n    }\n  }\n\n  return Buffer.from(result);\n};\n\nexports.encode = function (opts) {\n  const buf = alloc(512);\n  let name = opts.name;\n  let prefix = '';\n  if (opts.typeflag === 5 && name[name.length - 1] !== '/') name += '/';\n  if (Buffer.byteLength(name) !== name.length) return null; // utf-8\n\n  while (Buffer.byteLength(name) > 100) {\n    const i = name.indexOf('/');\n    if (i === -1) return null;\n    prefix += prefix ? '/' + name.slice(0, i) : name.slice(0, i);\n    name = name.slice(i + 1);\n  }\n\n  if (Buffer.byteLength(name) > 100 || Buffer.byteLength(prefix) > 155) return null;\n  if (opts.linkname && Buffer.byteLength(opts.linkname) > 100) return null;\n  buf.write(name);\n  buf.write(encodeOct(opts.mode & MASK, 6), 100);\n  buf.write(encodeOct(opts.uid, 6), 108);\n  buf.write(encodeOct(opts.gid, 6), 116);\n  buf.write(encodeOct(opts.size, 11), 124);\n  buf.write(encodeOct(opts.mtime.getTime() / 1000 | 0, 11), 136);\n  buf[156] = ZERO_OFFSET + toTypeflag(opts.type);\n  if (opts.linkname) buf.write(opts.linkname, 157);\n  USTAR_MAGIC.copy(buf, MAGIC_OFFSET);\n  USTAR_VER.copy(buf, VERSION_OFFSET);\n  if (opts.uname) buf.write(opts.uname, 265);\n  if (opts.gname) buf.write(opts.gname, 297);\n  buf.write(encodeOct(opts.devmajor || 0, 6), 329);\n  buf.write(encodeOct(opts.devminor || 0, 6), 337);\n  if (prefix) buf.write(prefix, 345);\n  buf.write(encodeOct(cksum(buf), 6), 148);\n  return buf;\n};","map":{"version":3,"names":["Buffer","require","alloc","ZEROS","SEVENS","ZERO_OFFSET","charCodeAt","USTAR_MAGIC","from","USTAR_VER","MASK","parseInt","MAGIC_OFFSET","VERSION_OFFSET","toTypeflag","flag","cksum","block","sum","i","j","encodeOct","val","n","toString","length","slice","addLength","str","len","byteLength","digits","Math","floor","log","pow","exports","encodePax","opts","result","name","linkname","pax","key","encode","buf","prefix","typeflag","indexOf","write","mode","uid","gid","size","mtime","getTime","type","copy","uname","gname","devmajor","devminor"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/it-tar/pack-headers.js"],"sourcesContent":["const { Buffer } = require('buffer')\n\nconst alloc = Buffer.alloc\n\nconst ZEROS = '0000000000000000000'\nconst SEVENS = '7777777777777777777'\nconst ZERO_OFFSET = '0'.charCodeAt(0)\nconst USTAR_MAGIC = Buffer.from('ustar\\x00', 'binary')\nconst USTAR_VER = Buffer.from('00', 'binary')\nconst MASK = parseInt('7777', 8)\nconst MAGIC_OFFSET = 257\nconst VERSION_OFFSET = 263\n\nconst toTypeflag = function (flag) {\n  switch (flag) {\n    case 'file':\n      return 0\n    case 'link':\n      return 1\n    case 'symlink':\n      return 2\n    case 'character-device':\n      return 3\n    case 'block-device':\n      return 4\n    case 'directory':\n      return 5\n    case 'fifo':\n      return 6\n    case 'contiguous-file':\n      return 7\n    case 'pax-header':\n      return 72\n  }\n\n  return 0\n}\n\nconst cksum = function (block) {\n  let sum = 8 * 32\n  for (let i = 0; i < 148; i++) sum += block[i]\n  for (let j = 156; j < 512; j++) sum += block[j]\n  return sum\n}\n\nconst encodeOct = function (val, n) {\n  val = val.toString(8)\n  if (val.length > n) return SEVENS.slice(0, n) + ' '\n  else return ZEROS.slice(0, n - val.length) + val + ' '\n}\n\nconst addLength = function (str) {\n  const len = Buffer.byteLength(str)\n  let digits = Math.floor(Math.log(len) / Math.log(10)) + 1\n  if (len + digits >= Math.pow(10, digits)) digits++\n\n  return (len + digits) + str\n}\n\nexports.encodePax = function (opts) { // TODO: encode more stuff in pax\n  let result = ''\n  if (opts.name) result += addLength(' path=' + opts.name + '\\n')\n  if (opts.linkname) result += addLength(' linkpath=' + opts.linkname + '\\n')\n  const pax = opts.pax\n  if (pax) {\n    for (const key in pax) {\n      result += addLength(' ' + key + '=' + pax[key] + '\\n')\n    }\n  }\n  return Buffer.from(result)\n}\n\nexports.encode = function (opts) {\n  const buf = alloc(512)\n  let name = opts.name\n  let prefix = ''\n\n  if (opts.typeflag === 5 && name[name.length - 1] !== '/') name += '/'\n  if (Buffer.byteLength(name) !== name.length) return null // utf-8\n\n  while (Buffer.byteLength(name) > 100) {\n    const i = name.indexOf('/')\n    if (i === -1) return null\n    prefix += prefix ? '/' + name.slice(0, i) : name.slice(0, i)\n    name = name.slice(i + 1)\n  }\n\n  if (Buffer.byteLength(name) > 100 || Buffer.byteLength(prefix) > 155) return null\n  if (opts.linkname && Buffer.byteLength(opts.linkname) > 100) return null\n\n  buf.write(name)\n  buf.write(encodeOct(opts.mode & MASK, 6), 100)\n  buf.write(encodeOct(opts.uid, 6), 108)\n  buf.write(encodeOct(opts.gid, 6), 116)\n  buf.write(encodeOct(opts.size, 11), 124)\n  buf.write(encodeOct((opts.mtime.getTime() / 1000) | 0, 11), 136)\n\n  buf[156] = ZERO_OFFSET + toTypeflag(opts.type)\n\n  if (opts.linkname) buf.write(opts.linkname, 157)\n\n  USTAR_MAGIC.copy(buf, MAGIC_OFFSET)\n  USTAR_VER.copy(buf, VERSION_OFFSET)\n  if (opts.uname) buf.write(opts.uname, 265)\n  if (opts.gname) buf.write(opts.gname, 297)\n  buf.write(encodeOct(opts.devmajor || 0, 6), 329)\n  buf.write(encodeOct(opts.devminor || 0, 6), 337)\n\n  if (prefix) buf.write(prefix, 345)\n\n  buf.write(encodeOct(cksum(buf), 6), 148)\n\n  return buf\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}