{"ast":null,"code":"const Fifo = require('fast-fifo');\n\nconst defer = require('p-defer');\n\nmodule.exports = class PFifo {\n  constructor() {\n    this._buffer = new Fifo();\n    this._waitingConsumers = new Fifo();\n  }\n\n  push(chunk) {\n    const {\n      promise,\n      resolve\n    } = defer();\n\n    this._buffer.push({\n      chunk,\n      resolve\n    });\n\n    this._consume();\n\n    return promise;\n  }\n\n  _consume() {\n    while (!this._waitingConsumers.isEmpty() && !this._buffer.isEmpty()) {\n      const nextConsumer = this._waitingConsumers.shift();\n\n      const nextChunk = this._buffer.shift();\n\n      nextConsumer.resolve(nextChunk.chunk);\n      nextChunk.resolve();\n    }\n  }\n\n  shift() {\n    const {\n      promise,\n      resolve\n    } = defer();\n\n    this._waitingConsumers.push({\n      resolve\n    });\n\n    this._consume();\n\n    return promise;\n  }\n\n  isEmpty() {\n    return this._buffer.isEmpty();\n  }\n\n};","map":{"version":3,"names":["Fifo","require","defer","module","exports","PFifo","constructor","_buffer","_waitingConsumers","push","chunk","promise","resolve","_consume","isEmpty","nextConsumer","shift","nextChunk"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/p-fifo/index.js"],"sourcesContent":["const Fifo = require('fast-fifo')\nconst defer = require('p-defer')\n\nmodule.exports = class PFifo {\n  constructor () {\n    this._buffer = new Fifo()\n    this._waitingConsumers = new Fifo()\n  }\n\n  push (chunk) {\n    const { promise, resolve } = defer()\n    this._buffer.push({ chunk, resolve })\n    this._consume()\n    return promise\n  }\n\n  _consume () {\n    while (!this._waitingConsumers.isEmpty() && !this._buffer.isEmpty()) {\n      const nextConsumer = this._waitingConsumers.shift()\n      const nextChunk = this._buffer.shift()\n      nextConsumer.resolve(nextChunk.chunk)\n      nextChunk.resolve()\n    }\n  }\n\n  shift () {\n    const { promise, resolve } = defer()\n    this._waitingConsumers.push({ resolve })\n    this._consume()\n    return promise\n  }\n\n  isEmpty () {\n    return this._buffer.isEmpty()\n  }\n}\n"],"mappings":"AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,WAAD,CAApB;;AACA,MAAMC,KAAK,GAAGD,OAAO,CAAC,SAAD,CAArB;;AAEAE,MAAM,CAACC,OAAP,GAAiB,MAAMC,KAAN,CAAY;EAC3BC,WAAW,GAAI;IACb,KAAKC,OAAL,GAAe,IAAIP,IAAJ,EAAf;IACA,KAAKQ,iBAAL,GAAyB,IAAIR,IAAJ,EAAzB;EACD;;EAEDS,IAAI,CAAEC,KAAF,EAAS;IACX,MAAM;MAAEC,OAAF;MAAWC;IAAX,IAAuBV,KAAK,EAAlC;;IACA,KAAKK,OAAL,CAAaE,IAAb,CAAkB;MAAEC,KAAF;MAASE;IAAT,CAAlB;;IACA,KAAKC,QAAL;;IACA,OAAOF,OAAP;EACD;;EAEDE,QAAQ,GAAI;IACV,OAAO,CAAC,KAAKL,iBAAL,CAAuBM,OAAvB,EAAD,IAAqC,CAAC,KAAKP,OAAL,CAAaO,OAAb,EAA7C,EAAqE;MACnE,MAAMC,YAAY,GAAG,KAAKP,iBAAL,CAAuBQ,KAAvB,EAArB;;MACA,MAAMC,SAAS,GAAG,KAAKV,OAAL,CAAaS,KAAb,EAAlB;;MACAD,YAAY,CAACH,OAAb,CAAqBK,SAAS,CAACP,KAA/B;MACAO,SAAS,CAACL,OAAV;IACD;EACF;;EAEDI,KAAK,GAAI;IACP,MAAM;MAAEL,OAAF;MAAWC;IAAX,IAAuBV,KAAK,EAAlC;;IACA,KAAKM,iBAAL,CAAuBC,IAAvB,CAA4B;MAAEG;IAAF,CAA5B;;IACA,KAAKC,QAAL;;IACA,OAAOF,OAAP;EACD;;EAEDG,OAAO,GAAI;IACT,OAAO,KAAKP,OAAL,CAAaO,OAAb,EAAP;EACD;;AA/B0B,CAA7B"},"metadata":{},"sourceType":"script"}