{"ast":null,"code":"'use strict';\n\nconst waitForPeers = async (ipfs, peersToWait, topic, isClosed) => {\n  const checkPeers = async () => {\n    const peers = await ipfs.pubsub.peers(topic);\n    const hasAllPeers = peersToWait.map(e => peers.includes(e)).filter(e => e === false).length === 0;\n    return hasAllPeers;\n  };\n\n  if (await checkPeers()) {\n    return Promise.resolve();\n  }\n\n  return new Promise(async (resolve, reject) => {\n    const interval = setInterval(async () => {\n      try {\n        if (isClosed()) {\n          clearInterval(interval);\n        } else if (await checkPeers()) {\n          clearInterval(interval);\n          resolve();\n        }\n      } catch (e) {\n        reject(e);\n      }\n    }, 100);\n  });\n};\n\nmodule.exports = waitForPeers;","map":{"version":3,"names":["waitForPeers","ipfs","peersToWait","topic","isClosed","checkPeers","peers","pubsub","hasAllPeers","map","e","includes","filter","length","Promise","resolve","reject","interval","setInterval","clearInterval","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/ipfs-pubsub-1on1/src/wait-for-peers.js"],"sourcesContent":["'use strict'\n\nconst waitForPeers = async (ipfs, peersToWait, topic, isClosed) => {\n  const checkPeers = async () => {\n    const peers = await ipfs.pubsub.peers(topic)\n    const hasAllPeers = peersToWait.map((e) => peers.includes(e)).filter((e) => e === false).length === 0\n    return hasAllPeers\n  }\n\n  if (await checkPeers()) {\n    return Promise.resolve()\n  }\n\n  return new Promise(async (resolve, reject) => {\n    const interval = setInterval(async () => {\n      try {\n        if (isClosed()) {\n          clearInterval(interval)\n        } else if (await checkPeers()) {\n          clearInterval(interval)\n          resolve()\n        }\n      } catch (e) {\n        reject(e)\n      }\n    }, 100)\n  })\n}\n\nmodule.exports = waitForPeers\n"],"mappings":"AAAA;;AAEA,MAAMA,YAAY,GAAG,OAAOC,IAAP,EAAaC,WAAb,EAA0BC,KAA1B,EAAiCC,QAAjC,KAA8C;EACjE,MAAMC,UAAU,GAAG,YAAY;IAC7B,MAAMC,KAAK,GAAG,MAAML,IAAI,CAACM,MAAL,CAAYD,KAAZ,CAAkBH,KAAlB,CAApB;IACA,MAAMK,WAAW,GAAGN,WAAW,CAACO,GAAZ,CAAiBC,CAAD,IAAOJ,KAAK,CAACK,QAAN,CAAeD,CAAf,CAAvB,EAA0CE,MAA1C,CAAkDF,CAAD,IAAOA,CAAC,KAAK,KAA9D,EAAqEG,MAArE,KAAgF,CAApG;IACA,OAAOL,WAAP;EACD,CAJD;;EAMA,IAAI,MAAMH,UAAU,EAApB,EAAwB;IACtB,OAAOS,OAAO,CAACC,OAAR,EAAP;EACD;;EAED,OAAO,IAAID,OAAJ,CAAY,OAAOC,OAAP,EAAgBC,MAAhB,KAA2B;IAC5C,MAAMC,QAAQ,GAAGC,WAAW,CAAC,YAAY;MACvC,IAAI;QACF,IAAId,QAAQ,EAAZ,EAAgB;UACde,aAAa,CAACF,QAAD,CAAb;QACD,CAFD,MAEO,IAAI,MAAMZ,UAAU,EAApB,EAAwB;UAC7Bc,aAAa,CAACF,QAAD,CAAb;UACAF,OAAO;QACR;MACF,CAPD,CAOE,OAAOL,CAAP,EAAU;QACVM,MAAM,CAACN,CAAD,CAAN;MACD;IACF,CAX2B,EAWzB,GAXyB,CAA5B;EAYD,CAbM,CAAP;AAcD,CAzBD;;AA2BAU,MAAM,CAACC,OAAP,GAAiBrB,YAAjB"},"metadata":{},"sourceType":"script"}