{"ast":null,"code":"import { makeAutoObservable, runInAction } from \"mobx\";\nimport User from \"../models/User.js\";\nexport default class UserStore {\n  constructor(rootStore) {\n    this.rootStore = rootStore;\n    this.userDb = undefined;\n    makeAutoObservable(this);\n  }\n\n  async init() {\n    await this.setUserStore();\n  }\n\n  isUserStoreReady() {\n    return !!this.userDb;\n  }\n\n  async setUserStore() {\n    if (this.rootStore.dataStore.orbitDb === undefined) throw Error(\"OrbitDb not defined!\");\n    const defaultOptions = {\n      accessController: {\n        write: [this.rootStore.dataStore.orbitDb.identity.id]\n      }\n    };\n    runInAction(async () => {\n      this.userDb = await this.rootStore.dataStore.orbitDb.kvstore(\"user\", defaultOptions);\n      await this.userDb.load();\n    });\n  }\n\n  async createUser(username) {\n    const peerId = await this.rootStore.dataStore.getPeerId();\n    const user = new User(username, peerId);\n    await this.userDb.set(\"user\", user);\n  }\n\n  async deleteProfileField(key) {\n    const cid = await this.userDb.del(key);\n    return cid;\n  }\n\n  getAllProfileFields() {\n    return this.userDb.all;\n  }\n\n  getProfileField(key) {\n    return this.userDb.get(key);\n  }\n\n  async updateUserField(key, value) {\n    const cid = await this.userDb.set(key, value);\n    return cid;\n  }\n\n}","map":{"version":3,"names":["makeAutoObservable","runInAction","User","UserStore","constructor","rootStore","userDb","undefined","init","setUserStore","isUserStoreReady","dataStore","orbitDb","Error","defaultOptions","accessController","write","identity","id","kvstore","load","createUser","username","peerId","getPeerId","user","set","deleteProfileField","key","cid","del","getAllProfileFields","all","getProfileField","get","updateUserField","value"],"sources":["C:/Users/zajan/GitHub/chatApplication/src/data/store/UserStore.js"],"sourcesContent":["import { makeAutoObservable, runInAction } from \"mobx\";\r\nimport User from \"../models/User.js\";\r\n\r\nexport default class UserStore {\r\n  userDb;\r\n  constructor(rootStore) {\r\n    this.rootStore = rootStore;\r\n    this.userDb = undefined;\r\n    makeAutoObservable(this);\r\n  }\r\n\r\n  async init() {\r\n    await this.setUserStore();\r\n  }\r\n  isUserStoreReady() {\r\n    return !!this.userDb;\r\n  }\r\n  async setUserStore() {\r\n    if (this.rootStore.dataStore.orbitDb === undefined) throw Error(\"OrbitDb not defined!\");\r\n    const defaultOptions = { accessController: { write: [this.rootStore.dataStore.orbitDb.identity.id] } };\r\n    runInAction(async () => {\r\n      this.userDb = await this.rootStore.dataStore.orbitDb.kvstore(\"user\", defaultOptions);\r\n      await this.userDb.load();\r\n    });\r\n  }\r\n  async createUser(username) {\r\n    const peerId = await this.rootStore.dataStore.getPeerId();\r\n    const user = new User(username, peerId);\r\n    await this.userDb.set(\"user\", user);\r\n  }\r\n\r\n  async deleteProfileField(key) {\r\n    const cid = await this.userDb.del(key);\r\n    return cid;\r\n  }\r\n\r\n  getAllProfileFields() {\r\n    return this.userDb.all;\r\n  }\r\n\r\n  getProfileField(key) {\r\n    return this.userDb.get(key);\r\n  }\r\n\r\n  async updateUserField(key, value) {\r\n    const cid = await this.userDb.set(key, value);\r\n    return cid;\r\n  }\r\n}\r\n"],"mappings":"AAAA,SAASA,kBAAT,EAA6BC,WAA7B,QAAgD,MAAhD;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AAEA,eAAe,MAAMC,SAAN,CAAgB;EAE7BC,WAAW,CAACC,SAAD,EAAY;IACrB,KAAKA,SAAL,GAAiBA,SAAjB;IACA,KAAKC,MAAL,GAAcC,SAAd;IACAP,kBAAkB,CAAC,IAAD,CAAlB;EACD;;EAES,MAAJQ,IAAI,GAAG;IACX,MAAM,KAAKC,YAAL,EAAN;EACD;;EACDC,gBAAgB,GAAG;IACjB,OAAO,CAAC,CAAC,KAAKJ,MAAd;EACD;;EACiB,MAAZG,YAAY,GAAG;IACnB,IAAI,KAAKJ,SAAL,CAAeM,SAAf,CAAyBC,OAAzB,KAAqCL,SAAzC,EAAoD,MAAMM,KAAK,CAAC,sBAAD,CAAX;IACpD,MAAMC,cAAc,GAAG;MAAEC,gBAAgB,EAAE;QAAEC,KAAK,EAAE,CAAC,KAAKX,SAAL,CAAeM,SAAf,CAAyBC,OAAzB,CAAiCK,QAAjC,CAA0CC,EAA3C;MAAT;IAApB,CAAvB;IACAjB,WAAW,CAAC,YAAY;MACtB,KAAKK,MAAL,GAAc,MAAM,KAAKD,SAAL,CAAeM,SAAf,CAAyBC,OAAzB,CAAiCO,OAAjC,CAAyC,MAAzC,EAAiDL,cAAjD,CAApB;MACA,MAAM,KAAKR,MAAL,CAAYc,IAAZ,EAAN;IACD,CAHU,CAAX;EAID;;EACe,MAAVC,UAAU,CAACC,QAAD,EAAW;IACzB,MAAMC,MAAM,GAAG,MAAM,KAAKlB,SAAL,CAAeM,SAAf,CAAyBa,SAAzB,EAArB;IACA,MAAMC,IAAI,GAAG,IAAIvB,IAAJ,CAASoB,QAAT,EAAmBC,MAAnB,CAAb;IACA,MAAM,KAAKjB,MAAL,CAAYoB,GAAZ,CAAgB,MAAhB,EAAwBD,IAAxB,CAAN;EACD;;EAEuB,MAAlBE,kBAAkB,CAACC,GAAD,EAAM;IAC5B,MAAMC,GAAG,GAAG,MAAM,KAAKvB,MAAL,CAAYwB,GAAZ,CAAgBF,GAAhB,CAAlB;IACA,OAAOC,GAAP;EACD;;EAEDE,mBAAmB,GAAG;IACpB,OAAO,KAAKzB,MAAL,CAAY0B,GAAnB;EACD;;EAEDC,eAAe,CAACL,GAAD,EAAM;IACnB,OAAO,KAAKtB,MAAL,CAAY4B,GAAZ,CAAgBN,GAAhB,CAAP;EACD;;EAEoB,MAAfO,eAAe,CAACP,GAAD,EAAMQ,KAAN,EAAa;IAChC,MAAMP,GAAG,GAAG,MAAM,KAAKvB,MAAL,CAAYoB,GAAZ,CAAgBE,GAAhB,EAAqBQ,KAArB,CAAlB;IACA,OAAOP,GAAP;EACD;;AA5C4B"},"metadata":{},"sourceType":"module"}