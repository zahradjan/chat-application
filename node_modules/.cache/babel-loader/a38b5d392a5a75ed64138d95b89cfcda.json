{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/esm/createClass.js\";import{makeAutoObservable,runInAction}from\"mobx\";import User from\"../models/User.js\";var UserStore=/*#__PURE__*/function(){function UserStore(rootStore){_classCallCheck(this,UserStore);this.rootStore=rootStore;this.userDb=undefined;makeAutoObservable(this);}_createClass(UserStore,[{key:\"init\",value:function(){var _init=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.setUserStore();case 2:case\"end\":return _context.stop();}}},_callee,this);}));function init(){return _init.apply(this,arguments);}return init;}()},{key:\"isUserStoreReady\",value:function isUserStoreReady(){return this.userDb;}},{key:\"setUserStore\",value:function(){var _setUserStore=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var defaultOptions;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(this.rootStore.dataStore.orbitDb===undefined)){_context2.next=2;break;}throw Error(\"OrbitDb not defined!\");case 2:defaultOptions={accessController:{write:[this.rootStore.dataStore.orbitDb.identity.id]}};_context2.next=5;return this.rootStore.dataStore.orbitDb.kvstore(\"user\",defaultOptions);case 5:this.userDb=_context2.sent;_context2.next=8;return this.userDb.load();case 8:case\"end\":return _context2.stop();}}},_callee2,this);}));function setUserStore(){return _setUserStore.apply(this,arguments);}return setUserStore;}()},{key:\"createUser\",value:function(){var _createUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(username){var peerId,user;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:peerId=this.rootStore.dataStore.peerId;user=new User(username,peerId);_context3.next=4;return this.userDb.set(\"user\",user);case 4:case\"end\":return _context3.stop();}}},_callee3,this);}));function createUser(_x){return _createUser.apply(this,arguments);}return createUser;}()},{key:\"deleteProfileField\",value:function(){var _deleteProfileField=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(key){var cid;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.userDb.del(key);case 2:cid=_context4.sent;return _context4.abrupt(\"return\",cid);case 4:case\"end\":return _context4.stop();}}},_callee4,this);}));function deleteProfileField(_x2){return _deleteProfileField.apply(this,arguments);}return deleteProfileField;}()},{key:\"getAllProfileFields\",value:function getAllProfileFields(){return this.userDb.all;}},{key:\"getProfileField\",value:function getProfileField(key){return this.userDb.get(key);}},{key:\"updateUserField\",value:function(){var _updateUserField=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(key,value){var cid;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return this.userDb.set(key,value);case 2:cid=_context5.sent;return _context5.abrupt(\"return\",cid);case 4:case\"end\":return _context5.stop();}}},_callee5,this);}));function updateUserField(_x3,_x4){return _updateUserField.apply(this,arguments);}return updateUserField;}()},{key:\"getUserDbId\",value:function(){var _getUserDbId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(){var id;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return this.userDb.id;case 2:id=_context6.sent;return _context6.abrupt(\"return\",id);case 4:case\"end\":return _context6.stop();}}},_callee6,this);}));function getUserDbId(){return _getUserDbId.apply(this,arguments);}return getUserDbId;}()}]);return UserStore;}();export{UserStore as default};","map":{"version":3,"names":["makeAutoObservable","runInAction","User","UserStore","rootStore","userDb","undefined","setUserStore","dataStore","orbitDb","Error","defaultOptions","accessController","write","identity","id","kvstore","load","username","peerId","user","set","key","del","cid","all","get","value"],"sources":["C:/Users/zajan/GitHub/chatApplication/src/data/store/UserStore.js"],"sourcesContent":["import { makeAutoObservable, runInAction } from \"mobx\";\r\nimport User from \"../models/User.js\";\r\n\r\nexport default class UserStore {\r\n  userDb;\r\n  constructor(rootStore) {\r\n    this.rootStore = rootStore;\r\n    this.userDb = undefined;\r\n    makeAutoObservable(this);\r\n  }\r\n\r\n  async init() {\r\n    await this.setUserStore();\r\n  }\r\n  isUserStoreReady() {\r\n    return this.userDb;\r\n  }\r\n  async setUserStore() {\r\n    if (this.rootStore.dataStore.orbitDb === undefined) throw Error(\"OrbitDb not defined!\");\r\n    const defaultOptions = { accessController: { write: [this.rootStore.dataStore.orbitDb.identity.id] } };\r\n\r\n    this.userDb = await this.rootStore.dataStore.orbitDb.kvstore(\"user\", defaultOptions);\r\n    await this.userDb.load();\r\n  }\r\n  async createUser(username) {\r\n    const peerId = this.rootStore.dataStore.peerId;\r\n    const user = new User(username, peerId);\r\n\r\n    await this.userDb.set(\"user\", user);\r\n  }\r\n\r\n  async deleteProfileField(key) {\r\n    const cid = await this.userDb.del(key);\r\n    return cid;\r\n  }\r\n\r\n  getAllProfileFields() {\r\n    return this.userDb.all;\r\n  }\r\n\r\n  getProfileField(key) {\r\n    return this.userDb.get(key);\r\n  }\r\n\r\n  async updateUserField(key, value) {\r\n    const cid = await this.userDb.set(key, value);\r\n    return cid;\r\n  }\r\n\r\n  async getUserDbId() {\r\n    const id = await this.userDb.id;\r\n    return id;\r\n  }\r\n}\r\n"],"mappings":"0fAAA,OAASA,kBAAT,CAA6BC,WAA7B,KAAgD,MAAhD,CACA,MAAOC,KAAP,KAAiB,mBAAjB,C,GAEqBC,U,yBAEnB,mBAAYC,SAAZ,CAAuB,iCACrB,KAAKA,SAAL,CAAiBA,SAAjB,CACA,KAAKC,MAAL,CAAcC,SAAd,CACAN,kBAAkB,CAAC,IAAD,CAAlB,CACD,C,yHAED,2JACQ,MAAKO,YAAL,EADR,4D,sGAGA,2BAAmB,CACjB,MAAO,MAAKF,MAAZ,CACD,C,mHACD,kKACM,KAAKD,SAAL,CAAeI,SAAf,CAAyBC,OAAzB,GAAqCH,SAD3C,gCAC4DI,MAAK,CAAC,sBAAD,CADjE,QAEQC,cAFR,CAEyB,CAAEC,gBAAgB,CAAE,CAAEC,KAAK,CAAE,CAAC,KAAKT,SAAL,CAAeI,SAAf,CAAyBC,OAAzB,CAAiCK,QAAjC,CAA0CC,EAA3C,CAAT,CAApB,CAFzB,wBAIsB,MAAKX,SAAL,CAAeI,SAAf,CAAyBC,OAAzB,CAAiCO,OAAjC,CAAyC,MAAzC,CAAiDL,cAAjD,CAJtB,QAIE,KAAKN,MAJP,uCAKQ,MAAKA,MAAL,CAAYY,IAAZ,EALR,8D,6MAOA,kBAAiBC,QAAjB,wIACQC,MADR,CACiB,KAAKf,SAAL,CAAeI,SAAf,CAAyBW,MAD1C,CAEQC,IAFR,CAEe,GAAIlB,KAAJ,CAASgB,QAAT,CAAmBC,MAAnB,CAFf,wBAIQ,MAAKd,MAAL,CAAYgB,GAAZ,CAAgB,MAAhB,CAAwBD,IAAxB,CAJR,8D,yNAOA,kBAAyBE,GAAzB,uJACoB,MAAKjB,MAAL,CAAYkB,GAAZ,CAAgBD,GAAhB,CADpB,QACQE,GADR,iDAESA,GAFT,+D,sJAKA,8BAAsB,CACpB,MAAO,MAAKnB,MAAL,CAAYoB,GAAnB,CACD,C,+BAED,yBAAgBH,GAAhB,CAAqB,CACnB,MAAO,MAAKjB,MAAL,CAAYqB,GAAZ,CAAgBJ,GAAhB,CAAP,CACD,C,yHAED,kBAAsBA,GAAtB,CAA2BK,KAA3B,uJACoB,MAAKtB,MAAL,CAAYgB,GAAZ,CAAgBC,GAAhB,CAAqBK,KAArB,CADpB,QACQH,GADR,iDAESA,GAFT,+D,+NAKA,wKACmB,MAAKnB,MAAL,CAAYU,EAD/B,QACQA,EADR,iDAESA,EAFT,+D,2HA9CmBZ,S"},"metadata":{},"sourceType":"module"}