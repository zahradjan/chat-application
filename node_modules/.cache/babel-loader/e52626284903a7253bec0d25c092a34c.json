{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar _inherits = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/inherits.js\").default;\n\nvar _createSuper = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/createSuper.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.XX = void 0;\n\nvar buffer_1 = require(\"buffer\");\n\nvar utils_1 = require(\"../utils\");\n\nvar abstract_handshake_1 = require(\"./abstract-handshake\");\n\nvar XX = /*#__PURE__*/function (_abstract_handshake_) {\n  _inherits(XX, _abstract_handshake_);\n\n  var _super = _createSuper(XX);\n\n  function XX() {\n    _classCallCheck(this, XX);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(XX, [{\n    key: \"initializeInitiator\",\n    value: function initializeInitiator(prologue, s, rs, psk) {\n      var name = 'Noise_XX_25519_ChaChaPoly_SHA256';\n      var ss = this.initializeSymmetric(name);\n      this.mixHash(ss, prologue);\n      var re = buffer_1.Buffer.alloc(32);\n      return {\n        ss: ss,\n        s: s,\n        rs: rs,\n        psk: psk,\n        re: re\n      };\n    }\n  }, {\n    key: \"initializeResponder\",\n    value: function initializeResponder(prologue, s, rs, psk) {\n      var name = 'Noise_XX_25519_ChaChaPoly_SHA256';\n      var ss = this.initializeSymmetric(name);\n      this.mixHash(ss, prologue);\n      var re = buffer_1.Buffer.alloc(32);\n      return {\n        ss: ss,\n        s: s,\n        rs: rs,\n        psk: psk,\n        re: re\n      };\n    }\n  }, {\n    key: \"writeMessageA\",\n    value: function writeMessageA(hs, payload, e) {\n      var ns = buffer_1.Buffer.alloc(0);\n\n      if (e !== undefined) {\n        hs.e = e;\n      } else {\n        hs.e = utils_1.generateKeypair();\n      }\n\n      var ne = hs.e.publicKey;\n      this.mixHash(hs.ss, ne);\n      var ciphertext = this.encryptAndHash(hs.ss, payload);\n      return {\n        ne: ne,\n        ns: ns,\n        ciphertext: ciphertext\n      };\n    }\n  }, {\n    key: \"writeMessageB\",\n    value: function writeMessageB(hs, payload) {\n      hs.e = utils_1.generateKeypair();\n      var ne = hs.e.publicKey;\n      this.mixHash(hs.ss, ne);\n      this.mixKey(hs.ss, this.dh(hs.e.privateKey, hs.re));\n      var spk = buffer_1.Buffer.from(hs.s.publicKey);\n      var ns = this.encryptAndHash(hs.ss, spk);\n      this.mixKey(hs.ss, this.dh(hs.s.privateKey, hs.re));\n      var ciphertext = this.encryptAndHash(hs.ss, payload);\n      return {\n        ne: ne,\n        ns: ns,\n        ciphertext: ciphertext\n      };\n    }\n  }, {\n    key: \"writeMessageC\",\n    value: function writeMessageC(hs, payload) {\n      var spk = buffer_1.Buffer.from(hs.s.publicKey);\n      var ns = this.encryptAndHash(hs.ss, spk);\n      this.mixKey(hs.ss, this.dh(hs.s.privateKey, hs.re));\n      var ciphertext = this.encryptAndHash(hs.ss, payload);\n      var ne = this.createEmptyKey();\n      var messageBuffer = {\n        ne: ne,\n        ns: ns,\n        ciphertext: ciphertext\n      };\n\n      var _this$split = this.split(hs.ss),\n          cs1 = _this$split.cs1,\n          cs2 = _this$split.cs2;\n\n      return {\n        h: hs.ss.h,\n        messageBuffer: messageBuffer,\n        cs1: cs1,\n        cs2: cs2\n      };\n    }\n  }, {\n    key: \"readMessageA\",\n    value: function readMessageA(hs, message) {\n      if (utils_1.isValidPublicKey(message.ne)) {\n        hs.re = message.ne;\n      }\n\n      this.mixHash(hs.ss, hs.re);\n      return this.decryptAndHash(hs.ss, message.ciphertext);\n    }\n  }, {\n    key: \"readMessageB\",\n    value: function readMessageB(hs, message) {\n      if (utils_1.isValidPublicKey(message.ne)) {\n        hs.re = message.ne;\n      }\n\n      this.mixHash(hs.ss, hs.re);\n\n      if (!hs.e) {\n        throw new Error('Handshake state `e` param is missing.');\n      }\n\n      this.mixKey(hs.ss, this.dh(hs.e.privateKey, hs.re));\n\n      var _this$decryptAndHash = this.decryptAndHash(hs.ss, message.ns),\n          ns = _this$decryptAndHash.plaintext,\n          valid1 = _this$decryptAndHash.valid;\n\n      if (valid1 && ns.length === 32 && utils_1.isValidPublicKey(ns)) {\n        hs.rs = ns;\n      }\n\n      this.mixKey(hs.ss, this.dh(hs.e.privateKey, hs.rs));\n\n      var _this$decryptAndHash2 = this.decryptAndHash(hs.ss, message.ciphertext),\n          plaintext = _this$decryptAndHash2.plaintext,\n          valid2 = _this$decryptAndHash2.valid;\n\n      return {\n        plaintext: plaintext,\n        valid: valid1 && valid2\n      };\n    }\n  }, {\n    key: \"readMessageC\",\n    value: function readMessageC(hs, message) {\n      var _this$decryptAndHash3 = this.decryptAndHash(hs.ss, message.ns),\n          ns = _this$decryptAndHash3.plaintext,\n          valid1 = _this$decryptAndHash3.valid;\n\n      if (valid1 && ns.length === 32 && utils_1.isValidPublicKey(ns)) {\n        hs.rs = ns;\n      }\n\n      if (!hs.e) {\n        throw new Error('Handshake state `e` param is missing.');\n      }\n\n      this.mixKey(hs.ss, this.dh(hs.e.privateKey, hs.rs));\n\n      var _this$decryptAndHash4 = this.decryptAndHash(hs.ss, message.ciphertext),\n          plaintext = _this$decryptAndHash4.plaintext,\n          valid2 = _this$decryptAndHash4.valid;\n\n      var _this$split2 = this.split(hs.ss),\n          cs1 = _this$split2.cs1,\n          cs2 = _this$split2.cs2;\n\n      return {\n        h: hs.ss.h,\n        plaintext: plaintext,\n        valid: valid1 && valid2,\n        cs1: cs1,\n        cs2: cs2\n      };\n    }\n  }, {\n    key: \"initSession\",\n    value: function initSession(initiator, prologue, s) {\n      var psk = this.createEmptyKey();\n      var rs = buffer_1.Buffer.alloc(32); // no static key yet\n\n      var hs;\n\n      if (initiator) {\n        hs = this.initializeInitiator(prologue, s, rs, psk);\n      } else {\n        hs = this.initializeResponder(prologue, s, rs, psk);\n      }\n\n      return {\n        hs: hs,\n        i: initiator,\n        mc: 0\n      };\n    }\n  }, {\n    key: \"sendMessage\",\n    value: function sendMessage(session, message, ephemeral) {\n      var messageBuffer;\n\n      if (session.mc === 0) {\n        messageBuffer = this.writeMessageA(session.hs, message, ephemeral);\n      } else if (session.mc === 1) {\n        messageBuffer = this.writeMessageB(session.hs, message);\n      } else if (session.mc === 2) {\n        var _this$writeMessageC = this.writeMessageC(session.hs, message),\n            h = _this$writeMessageC.h,\n            resultingBuffer = _this$writeMessageC.messageBuffer,\n            cs1 = _this$writeMessageC.cs1,\n            cs2 = _this$writeMessageC.cs2;\n\n        messageBuffer = resultingBuffer;\n        session.h = h;\n        session.cs1 = cs1;\n        session.cs2 = cs2;\n      } else if (session.mc > 2) {\n        if (session.i) {\n          if (!session.cs1) {\n            throw new Error('CS1 (cipher state) is not defined');\n          }\n\n          messageBuffer = this.writeMessageRegular(session.cs1, message);\n        } else {\n          if (!session.cs2) {\n            throw new Error('CS2 (cipher state) is not defined');\n          }\n\n          messageBuffer = this.writeMessageRegular(session.cs2, message);\n        }\n      } else {\n        throw new Error('Session invalid.');\n      }\n\n      session.mc++;\n      return messageBuffer;\n    }\n  }, {\n    key: \"recvMessage\",\n    value: function recvMessage(session, message) {\n      var plaintext = buffer_1.Buffer.alloc(0);\n      var valid = false;\n\n      if (session.mc === 0) {\n        var _this$readMessageA = this.readMessageA(session.hs, message);\n\n        plaintext = _this$readMessageA.plaintext;\n        valid = _this$readMessageA.valid;\n      } else if (session.mc === 1) {\n        var _this$readMessageB = this.readMessageB(session.hs, message);\n\n        plaintext = _this$readMessageB.plaintext;\n        valid = _this$readMessageB.valid;\n      } else if (session.mc === 2) {\n        var _this$readMessageC = this.readMessageC(session.hs, message),\n            h = _this$readMessageC.h,\n            resultingPlaintext = _this$readMessageC.plaintext,\n            resultingValid = _this$readMessageC.valid,\n            cs1 = _this$readMessageC.cs1,\n            cs2 = _this$readMessageC.cs2;\n\n        plaintext = resultingPlaintext;\n        valid = resultingValid;\n        session.h = h;\n        session.cs1 = cs1;\n        session.cs2 = cs2;\n      }\n\n      session.mc++;\n      return {\n        plaintext: plaintext,\n        valid: valid\n      };\n    }\n  }]);\n\n  return XX;\n}(abstract_handshake_1.AbstractHandshake);\n\nexports.XX = XX;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;AAAA;;AAGA;;AAEA;;IAEaA,E;;;;;;;;;;;;;WACH,6BAAqBC,QAArB,EAAwCC,CAAxC,EAAoDC,EAApD,EAAiEC,GAAjE,EAA6E;MACnF,IAAMC,IAAI,GAAG,kCAAb;MACA,IAAMC,EAAE,GAAG,KAAKC,mBAAL,CAAyBF,IAAzB,CAAX;MACA,KAAKG,OAAL,CAAaF,EAAb,EAAiBL,QAAjB;MACA,IAAMQ,EAAE,GAAGC,gBAAOC,KAAP,CAAa,EAAb,CAAX;MAEA,OAAO;QAAEL,EAAE,EAAFA,EAAF;QAAMJ,CAAC,EAADA,CAAN;QAASC,EAAE,EAAFA,EAAT;QAAaC,GAAG,EAAHA,GAAb;QAAkBK,EAAE,EAAFA;MAAlB,CAAP;IACD;;;WAEO,6BAAqBR,QAArB,EAAwCC,CAAxC,EAAoDC,EAApD,EAAiEC,GAAjE,EAA6E;MACnF,IAAMC,IAAI,GAAG,kCAAb;MACA,IAAMC,EAAE,GAAG,KAAKC,mBAAL,CAAyBF,IAAzB,CAAX;MACA,KAAKG,OAAL,CAAaF,EAAb,EAAiBL,QAAjB;MACA,IAAMQ,EAAE,GAAGC,gBAAOC,KAAP,CAAa,EAAb,CAAX;MAEA,OAAO;QAAEL,EAAE,EAAFA,EAAF;QAAMJ,CAAC,EAADA,CAAN;QAASC,EAAE,EAAFA,EAAT;QAAaC,GAAG,EAAHA,GAAb;QAAkBK,EAAE,EAAFA;MAAlB,CAAP;IACD;;;WAEO,uBAAeG,EAAf,EAAmCC,OAAnC,EAAmDC,CAAnD,EAA8D;MACpE,IAAMC,EAAE,GAAGL,gBAAOC,KAAP,CAAa,CAAb,CAAX;;MAEA,IAAIG,CAAC,KAAKE,SAAV,EAAqB;QACnBJ,EAAE,CAACE,CAAH,GAAOA,CAAP;MACD,CAFD,MAEO;QACLF,EAAE,CAACE,CAAH,GAAOG,yBAAP;MACD;;MAED,IAAMC,EAAE,GAAGN,EAAE,CAACE,CAAH,CAAKK,SAAhB;MAEA,KAAKX,OAAL,CAAaI,EAAE,CAACN,EAAhB,EAAoBY,EAApB;MACA,IAAME,UAAU,GAAG,KAAKC,cAAL,CAAoBT,EAAE,CAACN,EAAvB,EAA2BO,OAA3B,CAAnB;MAEA,OAAO;QAAEK,EAAE,EAAFA,EAAF;QAAMH,EAAE,EAAFA,EAAN;QAAUK,UAAU,EAAVA;MAAV,CAAP;IACD;;;WAEO,uBAAeR,EAAf,EAAmCC,OAAnC,EAAiD;MACvDD,EAAE,CAACE,CAAH,GAAOG,yBAAP;MACA,IAAMC,EAAE,GAAGN,EAAE,CAACE,CAAH,CAAKK,SAAhB;MACA,KAAKX,OAAL,CAAaI,EAAE,CAACN,EAAhB,EAAoBY,EAApB;MAEA,KAAKI,MAAL,CAAYV,EAAE,CAACN,EAAf,EAAmB,KAAKiB,EAAL,CAAQX,EAAE,CAACE,CAAH,CAAKU,UAAb,EAAyBZ,EAAE,CAACH,EAA5B,CAAnB;MACA,IAAMgB,GAAG,GAAGf,gBAAOgB,IAAP,CAAYd,EAAE,CAACV,CAAH,CAAKiB,SAAjB,CAAZ;MACA,IAAMJ,EAAE,GAAG,KAAKM,cAAL,CAAoBT,EAAE,CAACN,EAAvB,EAA2BmB,GAA3B,CAAX;MAEA,KAAKH,MAAL,CAAYV,EAAE,CAACN,EAAf,EAAmB,KAAKiB,EAAL,CAAQX,EAAE,CAACV,CAAH,CAAKsB,UAAb,EAAyBZ,EAAE,CAACH,EAA5B,CAAnB;MACA,IAAMW,UAAU,GAAG,KAAKC,cAAL,CAAoBT,EAAE,CAACN,EAAvB,EAA2BO,OAA3B,CAAnB;MAEA,OAAO;QAAEK,EAAE,EAAFA,EAAF;QAAMH,EAAE,EAAFA,EAAN;QAAUK,UAAU,EAAVA;MAAV,CAAP;IACD;;;WAEO,uBAAeR,EAAf,EAAmCC,OAAnC,EAAiD;MACvD,IAAMY,GAAG,GAAGf,gBAAOgB,IAAP,CAAYd,EAAE,CAACV,CAAH,CAAKiB,SAAjB,CAAZ;MACA,IAAMJ,EAAE,GAAG,KAAKM,cAAL,CAAoBT,EAAE,CAACN,EAAvB,EAA2BmB,GAA3B,CAAX;MACA,KAAKH,MAAL,CAAYV,EAAE,CAACN,EAAf,EAAmB,KAAKiB,EAAL,CAAQX,EAAE,CAACV,CAAH,CAAKsB,UAAb,EAAyBZ,EAAE,CAACH,EAA5B,CAAnB;MACA,IAAMW,UAAU,GAAG,KAAKC,cAAL,CAAoBT,EAAE,CAACN,EAAvB,EAA2BO,OAA3B,CAAnB;MACA,IAAMK,EAAE,GAAG,KAAKS,cAAL,EAAX;MACA,IAAMC,aAAa,GAAkB;QAAEV,EAAE,EAAFA,EAAF;QAAMH,EAAE,EAAFA,EAAN;QAAUK,UAAU,EAAVA;MAAV,CAArC;;MACA,kBAAqB,KAAKS,KAAL,CAAWjB,EAAE,CAACN,EAAd,CAArB;MAAA,IAAQwB,GAAR,eAAQA,GAAR;MAAA,IAAaC,GAAb,eAAaA,GAAb;;MAEA,OAAO;QAAEC,CAAC,EAAEpB,EAAE,CAACN,EAAH,CAAM0B,CAAX;QAAcJ,aAAa,EAAbA,aAAd;QAA6BE,GAAG,EAAHA,GAA7B;QAAkCC,GAAG,EAAHA;MAAlC,CAAP;IACD;;;WAEO,sBAAcnB,EAAd,EAAkCqB,OAAlC,EAAwD;MAC9D,IAAIhB,yBAAiBgB,OAAO,CAACf,EAAzB,CAAJ,EAAkC;QAChCN,EAAE,CAACH,EAAH,GAAQwB,OAAO,CAACf,EAAhB;MACD;;MAED,KAAKV,OAAL,CAAaI,EAAE,CAACN,EAAhB,EAAoBM,EAAE,CAACH,EAAvB;MACA,OAAO,KAAKyB,cAAL,CAAoBtB,EAAE,CAACN,EAAvB,EAA2B2B,OAAO,CAACb,UAAnC,CAAP;IACD;;;WAEO,sBAAcR,EAAd,EAAkCqB,OAAlC,EAAwD;MAC9D,IAAIhB,yBAAiBgB,OAAO,CAACf,EAAzB,CAAJ,EAAkC;QAChCN,EAAE,CAACH,EAAH,GAAQwB,OAAO,CAACf,EAAhB;MACD;;MAED,KAAKV,OAAL,CAAaI,EAAE,CAACN,EAAhB,EAAoBM,EAAE,CAACH,EAAvB;;MACA,IAAI,CAACG,EAAE,CAACE,CAAR,EAAW;QACT,MAAM,IAAIqB,KAAJ,CAAU,uCAAV,CAAN;MACD;;MACD,KAAKb,MAAL,CAAYV,EAAE,CAACN,EAAf,EAAmB,KAAKiB,EAAL,CAAQX,EAAE,CAACE,CAAH,CAAKU,UAAb,EAAyBZ,EAAE,CAACH,EAA5B,CAAnB;;MACA,2BAAyC,KAAKyB,cAAL,CAAoBtB,EAAE,CAACN,EAAvB,EAA2B2B,OAAO,CAAClB,EAAnC,CAAzC;MAAA,IAAmBA,EAAnB,wBAAQqB,SAAR;MAAA,IAA8BC,MAA9B,wBAAuBC,KAAvB;;MACA,IAAID,MAAM,IAAItB,EAAE,CAACwB,MAAH,KAAc,EAAxB,IAA8BtB,yBAAiBF,EAAjB,CAAlC,EAAwD;QACtDH,EAAE,CAACT,EAAH,GAAQY,EAAR;MACD;;MACD,KAAKO,MAAL,CAAYV,EAAE,CAACN,EAAf,EAAmB,KAAKiB,EAAL,CAAQX,EAAE,CAACE,CAAH,CAAKU,UAAb,EAAyBZ,EAAE,CAACT,EAA5B,CAAnB;;MACA,4BAAqC,KAAK+B,cAAL,CAAoBtB,EAAE,CAACN,EAAvB,EAA2B2B,OAAO,CAACb,UAAnC,CAArC;MAAA,IAAQgB,SAAR,yBAAQA,SAAR;MAAA,IAA0BI,MAA1B,yBAAmBF,KAAnB;;MACA,OAAO;QAAEF,SAAS,EAATA,SAAF;QAAaE,KAAK,EAAGD,MAAM,IAAIG;MAA/B,CAAP;IACD;;;WAEO,sBAAc5B,EAAd,EAAkCqB,OAAlC,EAAwD;MAC9D,4BAAyC,KAAKC,cAAL,CAAoBtB,EAAE,CAACN,EAAvB,EAA2B2B,OAAO,CAAClB,EAAnC,CAAzC;MAAA,IAAmBA,EAAnB,yBAAQqB,SAAR;MAAA,IAA8BC,MAA9B,yBAAuBC,KAAvB;;MACA,IAAID,MAAM,IAAItB,EAAE,CAACwB,MAAH,KAAc,EAAxB,IAA8BtB,yBAAiBF,EAAjB,CAAlC,EAAwD;QACtDH,EAAE,CAACT,EAAH,GAAQY,EAAR;MACD;;MACD,IAAI,CAACH,EAAE,CAACE,CAAR,EAAW;QACT,MAAM,IAAIqB,KAAJ,CAAU,uCAAV,CAAN;MACD;;MACD,KAAKb,MAAL,CAAYV,EAAE,CAACN,EAAf,EAAmB,KAAKiB,EAAL,CAAQX,EAAE,CAACE,CAAH,CAAKU,UAAb,EAAyBZ,EAAE,CAACT,EAA5B,CAAnB;;MAEA,4BAAqC,KAAK+B,cAAL,CAAoBtB,EAAE,CAACN,EAAvB,EAA2B2B,OAAO,CAACb,UAAnC,CAArC;MAAA,IAAQgB,SAAR,yBAAQA,SAAR;MAAA,IAA0BI,MAA1B,yBAAmBF,KAAnB;;MACA,mBAAqB,KAAKT,KAAL,CAAWjB,EAAE,CAACN,EAAd,CAArB;MAAA,IAAQwB,GAAR,gBAAQA,GAAR;MAAA,IAAaC,GAAb,gBAAaA,GAAb;;MAEA,OAAO;QAAEC,CAAC,EAAEpB,EAAE,CAACN,EAAH,CAAM0B,CAAX;QAAcI,SAAS,EAATA,SAAd;QAAyBE,KAAK,EAAGD,MAAM,IAAIG,MAA3C;QAAoDV,GAAG,EAAHA,GAApD;QAAyDC,GAAG,EAAHA;MAAzD,CAAP;IACD;;;WAEM,qBAAaU,SAAb,EAAiCxC,QAAjC,EAAoDC,CAApD,EAA8D;MACnE,IAAME,GAAG,GAAG,KAAKuB,cAAL,EAAZ;MACA,IAAMxB,EAAE,GAAGO,gBAAOC,KAAP,CAAa,EAAb,CAAX,CAFmE,CAEvC;;MAC5B,IAAIC,EAAJ;;MAEA,IAAI6B,SAAJ,EAAe;QACb7B,EAAE,GAAG,KAAK8B,mBAAL,CAAyBzC,QAAzB,EAAmCC,CAAnC,EAAsCC,EAAtC,EAA0CC,GAA1C,CAAL;MACD,CAFD,MAEO;QACLQ,EAAE,GAAG,KAAK+B,mBAAL,CAAyB1C,QAAzB,EAAmCC,CAAnC,EAAsCC,EAAtC,EAA0CC,GAA1C,CAAL;MACD;;MAED,OAAO;QACLQ,EAAE,EAAFA,EADK;QAELgC,CAAC,EAAEH,SAFE;QAGLI,EAAE,EAAE;MAHC,CAAP;IAKD;;;WAEM,qBAAaC,OAAb,EAAoCb,OAApC,EAAoDc,SAApD,EAAuE;MAC5E,IAAInB,aAAJ;;MACA,IAAIkB,OAAO,CAACD,EAAR,KAAe,CAAnB,EAAsB;QACpBjB,aAAa,GAAG,KAAKoB,aAAL,CAAmBF,OAAO,CAAClC,EAA3B,EAA+BqB,OAA/B,EAAwCc,SAAxC,CAAhB;MACD,CAFD,MAEO,IAAID,OAAO,CAACD,EAAR,KAAe,CAAnB,EAAsB;QAC3BjB,aAAa,GAAG,KAAKqB,aAAL,CAAmBH,OAAO,CAAClC,EAA3B,EAA+BqB,OAA/B,CAAhB;MACD,CAFM,MAEA,IAAIa,OAAO,CAACD,EAAR,KAAe,CAAnB,EAAsB;QAC3B,0BAAwD,KAAKK,aAAL,CAAmBJ,OAAO,CAAClC,EAA3B,EAA+BqB,OAA/B,CAAxD;QAAA,IAAQD,CAAR,uBAAQA,CAAR;QAAA,IAA0BmB,eAA1B,uBAAWvB,aAAX;QAAA,IAA2CE,GAA3C,uBAA2CA,GAA3C;QAAA,IAAgDC,GAAhD,uBAAgDA,GAAhD;;QACAH,aAAa,GAAGuB,eAAhB;QACAL,OAAO,CAACd,CAAR,GAAYA,CAAZ;QACAc,OAAO,CAAChB,GAAR,GAAcA,GAAd;QACAgB,OAAO,CAACf,GAAR,GAAcA,GAAd;MACD,CANM,MAMA,IAAIe,OAAO,CAACD,EAAR,GAAa,CAAjB,EAAoB;QACzB,IAAIC,OAAO,CAACF,CAAZ,EAAe;UACb,IAAI,CAACE,OAAO,CAAChB,GAAb,EAAkB;YAChB,MAAM,IAAIK,KAAJ,CAAU,mCAAV,CAAN;UACD;;UAEDP,aAAa,GAAG,KAAKwB,mBAAL,CAAyBN,OAAO,CAAChB,GAAjC,EAAsCG,OAAtC,CAAhB;QACD,CAND,MAMO;UACL,IAAI,CAACa,OAAO,CAACf,GAAb,EAAkB;YAChB,MAAM,IAAII,KAAJ,CAAU,mCAAV,CAAN;UACD;;UAEDP,aAAa,GAAG,KAAKwB,mBAAL,CAAyBN,OAAO,CAACf,GAAjC,EAAsCE,OAAtC,CAAhB;QACD;MACF,CAdM,MAcA;QACL,MAAM,IAAIE,KAAJ,CAAU,kBAAV,CAAN;MACD;;MAEDW,OAAO,CAACD,EAAR;MACA,OAAOjB,aAAP;IACD;;;WAEM,qBAAakB,OAAb,EAAoCb,OAApC,EAA0D;MAC/D,IAAIG,SAAS,GAAU1B,gBAAOC,KAAP,CAAa,CAAb,CAAvB;MACA,IAAI2B,KAAK,GAAG,KAAZ;;MACA,IAAIQ,OAAO,CAACD,EAAR,KAAe,CAAnB,EAAsB;QAAA,yBACI,KAAKQ,YAAL,CAAkBP,OAAO,CAAClC,EAA1B,EAA8BqB,OAA9B,CADJ;;QACjBG,SADiB,sBACjBA,SADiB;QACNE,KADM,sBACNA,KADM;MAErB,CAFD,MAEO,IAAIQ,OAAO,CAACD,EAAR,KAAe,CAAnB,EAAsB;QAAA,yBACH,KAAKS,YAAL,CAAkBR,OAAO,CAAClC,EAA1B,EAA8BqB,OAA9B,CADG;;QACxBG,SADwB,sBACxBA,SADwB;QACbE,KADa,sBACbA,KADa;MAE5B,CAFM,MAEA,IAAIQ,OAAO,CAACD,EAAR,KAAe,CAAnB,EAAsB;QAC3B,yBAA8E,KAAKU,YAAL,CAAkBT,OAAO,CAAClC,EAA1B,EAA8BqB,OAA9B,CAA9E;QAAA,IAAQD,CAAR,sBAAQA,CAAR;QAAA,IAAsBwB,kBAAtB,sBAAWpB,SAAX;QAAA,IAAiDqB,cAAjD,sBAA0CnB,KAA1C;QAAA,IAAiER,GAAjE,sBAAiEA,GAAjE;QAAA,IAAsEC,GAAtE,sBAAsEA,GAAtE;;QACAK,SAAS,GAAGoB,kBAAZ;QACAlB,KAAK,GAAGmB,cAAR;QACAX,OAAO,CAACd,CAAR,GAAYA,CAAZ;QACAc,OAAO,CAAChB,GAAR,GAAcA,GAAd;QACAgB,OAAO,CAACf,GAAR,GAAcA,GAAd;MACD;;MACDe,OAAO,CAACD,EAAR;MACA,OAAO;QAAET,SAAS,EAATA,SAAF;QAAaE,KAAK,EAALA;MAAb,CAAP;IACD;;;;EAhLqBoB,sC;;AAAxBC","names":["XX","prologue","s","rs","psk","name","ss","initializeSymmetric","mixHash","re","buffer_1","alloc","hs","payload","e","ns","undefined","utils_1","ne","publicKey","ciphertext","encryptAndHash","mixKey","dh","privateKey","spk","from","createEmptyKey","messageBuffer","split","cs1","cs2","h","message","decryptAndHash","Error","plaintext","valid1","valid","length","valid2","initiator","initializeInitiator","initializeResponder","i","mc","session","ephemeral","writeMessageA","writeMessageB","writeMessageC","resultingBuffer","writeMessageRegular","readMessageA","readMessageB","readMessageC","resultingPlaintext","resultingValid","abstract_handshake_1","exports"],"sourceRoot":"","sources":["../../../src/handshakes/xx.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}