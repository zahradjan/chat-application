{"ast":null,"code":"'use strict';\n\nconst IdentityProvider = require('./identity-provider-interface');\n\nconst Keystore = require('orbit-db-keystore');\n\nconst type = 'orbitdb';\n\nclass OrbitDBIdentityProvider extends IdentityProvider {\n  constructor(keystore) {\n    super();\n\n    if (!keystore) {\n      throw new Error('OrbitDBIdentityProvider requires a keystore');\n    }\n\n    this._keystore = keystore;\n  } // Returns the type of the identity provider\n\n\n  static get type() {\n    return type;\n  }\n\n  async getId() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const id = options.id;\n\n    if (!id) {\n      throw new Error('id is required');\n    }\n\n    const keystore = this._keystore;\n    const key = (await keystore.getKey(id)) || (await keystore.createKey(id));\n    return key.public.marshal().toString('hex');\n  }\n\n  async signIdentity(data) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const id = options.id;\n\n    if (!id) {\n      throw new Error('id is required');\n    }\n\n    const keystore = this._keystore;\n    const key = await keystore.getKey(id);\n\n    if (!key) {\n      throw new Error(`Signing key for '${id}' not found`);\n    }\n\n    return keystore.sign(key, data);\n  }\n\n  static async verifyIdentity(identity) {\n    // Verify that identity was signed by the ID\n    return Keystore.verify(identity.signatures.publicKey, identity.id, identity.publicKey + identity.signatures.id);\n  }\n\n}\n\nmodule.exports = OrbitDBIdentityProvider;","map":{"version":3,"names":["IdentityProvider","require","Keystore","type","OrbitDBIdentityProvider","constructor","keystore","Error","_keystore","getId","options","id","key","getKey","createKey","public","marshal","toString","signIdentity","data","sign","verifyIdentity","identity","verify","signatures","publicKey","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/orbit-db-identity-provider/src/orbit-db-identity-provider.js"],"sourcesContent":["'use strict'\nconst IdentityProvider = require('./identity-provider-interface')\nconst Keystore = require('orbit-db-keystore')\nconst type = 'orbitdb'\n\nclass OrbitDBIdentityProvider extends IdentityProvider {\n  constructor (keystore) {\n    super()\n    if (!keystore) {\n      throw new Error('OrbitDBIdentityProvider requires a keystore')\n    }\n    this._keystore = keystore\n  }\n\n  // Returns the type of the identity provider\n  static get type () { return type }\n\n  async getId (options = {}) {\n    const id = options.id\n    if (!id) {\n      throw new Error('id is required')\n    }\n\n    const keystore = this._keystore\n    const key = await keystore.getKey(id) || await keystore.createKey(id)\n    return key.public.marshal().toString('hex')\n  }\n\n  async signIdentity (data, options = {}) {\n    const id = options.id\n    if (!id) {\n      throw new Error('id is required')\n    }\n    const keystore = this._keystore\n    const key = await keystore.getKey(id)\n    if (!key) {\n      throw new Error(`Signing key for '${id}' not found`)\n    }\n\n    return keystore.sign(key, data)\n  }\n\n  static async verifyIdentity (identity) {\n    // Verify that identity was signed by the ID\n    return Keystore.verify(\n      identity.signatures.publicKey,\n      identity.id,\n      identity.publicKey + identity.signatures.id\n    )\n  }\n}\n\nmodule.exports = OrbitDBIdentityProvider\n"],"mappings":"AAAA;;AACA,MAAMA,gBAAgB,GAAGC,OAAO,CAAC,+BAAD,CAAhC;;AACA,MAAMC,QAAQ,GAAGD,OAAO,CAAC,mBAAD,CAAxB;;AACA,MAAME,IAAI,GAAG,SAAb;;AAEA,MAAMC,uBAAN,SAAsCJ,gBAAtC,CAAuD;EACrDK,WAAW,CAAEC,QAAF,EAAY;IACrB;;IACA,IAAI,CAACA,QAAL,EAAe;MACb,MAAM,IAAIC,KAAJ,CAAU,6CAAV,CAAN;IACD;;IACD,KAAKC,SAAL,GAAiBF,QAAjB;EACD,CAPoD,CASrD;;;EACe,WAAJH,IAAI,GAAI;IAAE,OAAOA,IAAP;EAAa;;EAEvB,MAALM,KAAK,GAAgB;IAAA,IAAdC,OAAc,uEAAJ,EAAI;IACzB,MAAMC,EAAE,GAAGD,OAAO,CAACC,EAAnB;;IACA,IAAI,CAACA,EAAL,EAAS;MACP,MAAM,IAAIJ,KAAJ,CAAU,gBAAV,CAAN;IACD;;IAED,MAAMD,QAAQ,GAAG,KAAKE,SAAtB;IACA,MAAMI,GAAG,GAAG,OAAMN,QAAQ,CAACO,MAAT,CAAgBF,EAAhB,CAAN,MAA6B,MAAML,QAAQ,CAACQ,SAAT,CAAmBH,EAAnB,CAAnC,CAAZ;IACA,OAAOC,GAAG,CAACG,MAAJ,CAAWC,OAAX,GAAqBC,QAArB,CAA8B,KAA9B,CAAP;EACD;;EAEiB,MAAZC,YAAY,CAAEC,IAAF,EAAsB;IAAA,IAAdT,OAAc,uEAAJ,EAAI;IACtC,MAAMC,EAAE,GAAGD,OAAO,CAACC,EAAnB;;IACA,IAAI,CAACA,EAAL,EAAS;MACP,MAAM,IAAIJ,KAAJ,CAAU,gBAAV,CAAN;IACD;;IACD,MAAMD,QAAQ,GAAG,KAAKE,SAAtB;IACA,MAAMI,GAAG,GAAG,MAAMN,QAAQ,CAACO,MAAT,CAAgBF,EAAhB,CAAlB;;IACA,IAAI,CAACC,GAAL,EAAU;MACR,MAAM,IAAIL,KAAJ,CAAW,oBAAmBI,EAAG,aAAjC,CAAN;IACD;;IAED,OAAOL,QAAQ,CAACc,IAAT,CAAcR,GAAd,EAAmBO,IAAnB,CAAP;EACD;;EAE0B,aAAdE,cAAc,CAAEC,QAAF,EAAY;IACrC;IACA,OAAOpB,QAAQ,CAACqB,MAAT,CACLD,QAAQ,CAACE,UAAT,CAAoBC,SADf,EAELH,QAAQ,CAACX,EAFJ,EAGLW,QAAQ,CAACG,SAAT,GAAqBH,QAAQ,CAACE,UAAT,CAAoBb,EAHpC,CAAP;EAKD;;AA5CoD;;AA+CvDe,MAAM,CAACC,OAAP,GAAiBvB,uBAAjB"},"metadata":{},"sourceType":"script"}