{"ast":null,"code":"'use strict';\n\nconst errcode = require('err-code');\n\nconst {\n  toString: uint8ArrayToString\n} = require('uint8arrays/to-string');\n\nconst {\n  fromString: uint8ArrayFromString\n} = require('uint8arrays/from-string');\n/**\n * @typedef {import('interface-datastore').Key} Key\n */\n\n\nconst namespace = '/record/';\n/**\n * @param {Uint8Array} buf\n */\n\nfunction encodeBase32(buf) {\n  return uint8ArrayToString(buf, 'base32');\n}\n/**\n * converts a binary record key to a pubsub topic key\n *\n * @param {Uint8Array | string} key\n */\n\n\nfunction keyToTopic(key) {\n  // Record-store keys are arbitrary binary. However, pubsub requires UTF-8 string topic IDs\n  // Encodes to \"/record/base64url(key)\"\n  if (typeof key === 'string' || key instanceof String) {\n    key = uint8ArrayFromString(key.toString());\n  }\n\n  const b64url = uint8ArrayToString(key, 'base64url');\n  return `${namespace}${b64url}`;\n}\n/**\n * converts a pubsub topic key to a binary record key\n *\n * @param {string} topic\n */\n\n\nfunction topicToKey(topic) {\n  if (topic.substring(0, namespace.length) !== namespace) {\n    throw errcode(new Error('topic received is not from a record'), 'ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE');\n  }\n\n  const key = topic.substring(namespace.length);\n  return uint8ArrayFromString(key, 'base64url');\n}\n\nmodule.exports = {\n  encodeBase32,\n  keyToTopic,\n  topicToKey\n};","map":{"version":3,"names":["errcode","require","toString","uint8ArrayToString","fromString","uint8ArrayFromString","namespace","encodeBase32","buf","keyToTopic","key","String","b64url","topicToKey","topic","substring","length","Error","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/datastore-pubsub/src/utils.js"],"sourcesContent":["'use strict'\n\nconst errcode = require('err-code')\nconst { toString: uint8ArrayToString } = require('uint8arrays/to-string')\nconst { fromString: uint8ArrayFromString } = require('uint8arrays/from-string')\n\n/**\n * @typedef {import('interface-datastore').Key} Key\n */\n\nconst namespace = '/record/'\n\n/**\n * @param {Uint8Array} buf\n */\nfunction encodeBase32 (buf) {\n  return uint8ArrayToString(buf, 'base32')\n}\n\n/**\n * converts a binary record key to a pubsub topic key\n *\n * @param {Uint8Array | string} key\n */\nfunction keyToTopic (key) {\n  // Record-store keys are arbitrary binary. However, pubsub requires UTF-8 string topic IDs\n  // Encodes to \"/record/base64url(key)\"\n  if (typeof key === 'string' || key instanceof String) {\n    key = uint8ArrayFromString(key.toString())\n  }\n\n  const b64url = uint8ArrayToString(key, 'base64url')\n\n  return `${namespace}${b64url}`\n}\n\n/**\n * converts a pubsub topic key to a binary record key\n *\n * @param {string} topic\n */\nfunction topicToKey (topic) {\n  if (topic.substring(0, namespace.length) !== namespace) {\n    throw errcode(new Error('topic received is not from a record'), 'ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE')\n  }\n\n  const key = topic.substring(namespace.length)\n\n  return uint8ArrayFromString(key, 'base64url')\n}\n\nmodule.exports = {\n  encodeBase32,\n  keyToTopic,\n  topicToKey\n}\n"],"mappings":"AAAA;;AAEA,MAAMA,OAAO,GAAGC,OAAO,CAAC,UAAD,CAAvB;;AACA,MAAM;EAAEC,QAAQ,EAAEC;AAAZ,IAAmCF,OAAO,CAAC,uBAAD,CAAhD;;AACA,MAAM;EAAEG,UAAU,EAAEC;AAAd,IAAuCJ,OAAO,CAAC,yBAAD,CAApD;AAEA;AACA;AACA;;;AAEA,MAAMK,SAAS,GAAG,UAAlB;AAEA;AACA;AACA;;AACA,SAASC,YAAT,CAAuBC,GAAvB,EAA4B;EAC1B,OAAOL,kBAAkB,CAACK,GAAD,EAAM,QAAN,CAAzB;AACD;AAED;AACA;AACA;AACA;AACA;;;AACA,SAASC,UAAT,CAAqBC,GAArB,EAA0B;EACxB;EACA;EACA,IAAI,OAAOA,GAAP,KAAe,QAAf,IAA2BA,GAAG,YAAYC,MAA9C,EAAsD;IACpDD,GAAG,GAAGL,oBAAoB,CAACK,GAAG,CAACR,QAAJ,EAAD,CAA1B;EACD;;EAED,MAAMU,MAAM,GAAGT,kBAAkB,CAACO,GAAD,EAAM,WAAN,CAAjC;EAEA,OAAQ,GAAEJ,SAAU,GAAEM,MAAO,EAA7B;AACD;AAED;AACA;AACA;AACA;AACA;;;AACA,SAASC,UAAT,CAAqBC,KAArB,EAA4B;EAC1B,IAAIA,KAAK,CAACC,SAAN,CAAgB,CAAhB,EAAmBT,SAAS,CAACU,MAA7B,MAAyCV,SAA7C,EAAwD;IACtD,MAAMN,OAAO,CAAC,IAAIiB,KAAJ,CAAU,qCAAV,CAAD,EAAmD,wCAAnD,CAAb;EACD;;EAED,MAAMP,GAAG,GAAGI,KAAK,CAACC,SAAN,CAAgBT,SAAS,CAACU,MAA1B,CAAZ;EAEA,OAAOX,oBAAoB,CAACK,GAAD,EAAM,WAAN,CAA3B;AACD;;AAEDQ,MAAM,CAACC,OAAP,GAAiB;EACfZ,YADe;EAEfE,UAFe;EAGfI;AAHe,CAAjB"},"metadata":{},"sourceType":"script"}