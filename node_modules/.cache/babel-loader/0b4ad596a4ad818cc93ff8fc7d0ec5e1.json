{"ast":null,"code":"'use strict';\n\nvar _regeneratorRuntime = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\n\nvar _asyncToGenerator = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\n\nvar _asyncIterator = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/asyncIterator.js\").default;\n\nvar dirSharded = require('./dir-sharded.js');\n\nvar dirFlat = require('./dir-flat.js');\n\nfunction flatToShard(_x, _x2, _x3, _x4) {\n  return _flatToShard.apply(this, arguments);\n}\n\nfunction _flatToShard() {\n  _flatToShard = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(child, dir, threshold, options) {\n    var newDir, parent;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            newDir = dir;\n\n            if (!(dir instanceof dirFlat && dir.directChildrenCount() >= threshold)) {\n              _context.next = 5;\n              break;\n            }\n\n            _context.next = 4;\n            return convertToShard(dir, options);\n\n          case 4:\n            newDir = _context.sent;\n\n          case 5:\n            parent = newDir.parent;\n\n            if (!parent) {\n              _context.next = 14;\n              break;\n            }\n\n            if (!(newDir !== dir)) {\n              _context.next = 13;\n              break;\n            }\n\n            if (child) {\n              child.parent = newDir;\n            }\n\n            if (newDir.parentKey) {\n              _context.next = 11;\n              break;\n            }\n\n            throw new Error('No parent key found');\n\n          case 11:\n            _context.next = 13;\n            return parent.put(newDir.parentKey, newDir);\n\n          case 13:\n            return _context.abrupt(\"return\", flatToShard(newDir, parent, threshold, options));\n\n          case 14:\n            return _context.abrupt(\"return\", newDir);\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _flatToShard.apply(this, arguments);\n}\n\nfunction convertToShard(_x5, _x6) {\n  return _convertToShard.apply(this, arguments);\n}\n\nfunction _convertToShard() {\n  _convertToShard = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(oldDir, options) {\n    var newDir, _iteratorAbruptCompletion, _didIteratorError, _iteratorError, _iterator, _step, _step$value, key, child;\n\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            newDir = new dirSharded({\n              root: oldDir.root,\n              dir: true,\n              parent: oldDir.parent,\n              parentKey: oldDir.parentKey,\n              path: oldDir.path,\n              dirty: oldDir.dirty,\n              flat: false,\n              mtime: oldDir.mtime,\n              mode: oldDir.mode\n            }, options);\n            _iteratorAbruptCompletion = false;\n            _didIteratorError = false;\n            _context2.prev = 3;\n            _iterator = _asyncIterator(oldDir.eachChildSeries());\n\n          case 5:\n            _context2.next = 7;\n            return _iterator.next();\n\n          case 7:\n            if (!(_iteratorAbruptCompletion = !(_step = _context2.sent).done)) {\n              _context2.next = 14;\n              break;\n            }\n\n            _step$value = _step.value, key = _step$value.key, child = _step$value.child;\n            _context2.next = 11;\n            return newDir.put(key, child);\n\n          case 11:\n            _iteratorAbruptCompletion = false;\n            _context2.next = 5;\n            break;\n\n          case 14:\n            _context2.next = 20;\n            break;\n\n          case 16:\n            _context2.prev = 16;\n            _context2.t0 = _context2[\"catch\"](3);\n            _didIteratorError = true;\n            _iteratorError = _context2.t0;\n\n          case 20:\n            _context2.prev = 20;\n            _context2.prev = 21;\n\n            if (!(_iteratorAbruptCompletion && _iterator.return != null)) {\n              _context2.next = 25;\n              break;\n            }\n\n            _context2.next = 25;\n            return _iterator.return();\n\n          case 25:\n            _context2.prev = 25;\n\n            if (!_didIteratorError) {\n              _context2.next = 28;\n              break;\n            }\n\n            throw _iteratorError;\n\n          case 28:\n            return _context2.finish(25);\n\n          case 29:\n            return _context2.finish(20);\n\n          case 30:\n            return _context2.abrupt(\"return\", newDir);\n\n          case 31:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[3, 16, 20, 30], [21,, 25, 29]]);\n  }));\n  return _convertToShard.apply(this, arguments);\n}\n\nmodule.exports = flatToShard;","map":{"version":3,"names":["dirSharded","require","dirFlat","flatToShard","child","dir","threshold","options","newDir","directChildrenCount","convertToShard","parent","parentKey","Error","put","oldDir","root","path","dirty","flat","mtime","mode","eachChildSeries","key","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/ipfs-unixfs-importer/cjs/src/flat-to-shard.js"],"sourcesContent":["'use strict';\n\nvar dirSharded = require('./dir-sharded.js');\nvar dirFlat = require('./dir-flat.js');\n\nasync function flatToShard(child, dir, threshold, options) {\n  let newDir = dir;\n  if (dir instanceof dirFlat && dir.directChildrenCount() >= threshold) {\n    newDir = await convertToShard(dir, options);\n  }\n  const parent = newDir.parent;\n  if (parent) {\n    if (newDir !== dir) {\n      if (child) {\n        child.parent = newDir;\n      }\n      if (!newDir.parentKey) {\n        throw new Error('No parent key found');\n      }\n      await parent.put(newDir.parentKey, newDir);\n    }\n    return flatToShard(newDir, parent, threshold, options);\n  }\n  return newDir;\n}\nasync function convertToShard(oldDir, options) {\n  const newDir = new dirSharded({\n    root: oldDir.root,\n    dir: true,\n    parent: oldDir.parent,\n    parentKey: oldDir.parentKey,\n    path: oldDir.path,\n    dirty: oldDir.dirty,\n    flat: false,\n    mtime: oldDir.mtime,\n    mode: oldDir.mode\n  }, options);\n  for await (const {key, child} of oldDir.eachChildSeries()) {\n    await newDir.put(key, child);\n  }\n  return newDir;\n}\n\nmodule.exports = flatToShard;\n"],"mappings":"AAAA;;;;;;;;AAEA,IAAIA,UAAU,GAAGC,OAAO,CAAC,kBAAD,CAAxB;;AACA,IAAIC,OAAO,GAAGD,OAAO,CAAC,eAAD,CAArB;;SAEeE,W;;;;;4EAAf,iBAA2BC,KAA3B,EAAkCC,GAAlC,EAAuCC,SAAvC,EAAkDC,OAAlD;IAAA;IAAA;MAAA;QAAA;UAAA;YACMC,MADN,GACeH,GADf;;YAAA,MAEMA,GAAG,YAAYH,OAAf,IAA0BG,GAAG,CAACI,mBAAJ,MAA6BH,SAF7D;cAAA;cAAA;YAAA;;YAAA;YAAA,OAGmBI,cAAc,CAACL,GAAD,EAAME,OAAN,CAHjC;;UAAA;YAGIC,MAHJ;;UAAA;YAKQG,MALR,GAKiBH,MAAM,CAACG,MALxB;;YAAA,KAMMA,MANN;cAAA;cAAA;YAAA;;YAAA,MAOQH,MAAM,KAAKH,GAPnB;cAAA;cAAA;YAAA;;YAQM,IAAID,KAAJ,EAAW;cACTA,KAAK,CAACO,MAAN,GAAeH,MAAf;YACD;;YAVP,IAWWA,MAAM,CAACI,SAXlB;cAAA;cAAA;YAAA;;YAAA,MAYc,IAAIC,KAAJ,CAAU,qBAAV,CAZd;;UAAA;YAAA;YAAA,OAcYF,MAAM,CAACG,GAAP,CAAWN,MAAM,CAACI,SAAlB,EAA6BJ,MAA7B,CAdZ;;UAAA;YAAA,iCAgBWL,WAAW,CAACK,MAAD,EAASG,MAAT,EAAiBL,SAAjB,EAA4BC,OAA5B,CAhBtB;;UAAA;YAAA,iCAkBSC,MAlBT;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,C;;;;SAoBeE,c;;;;;+EAAf,kBAA8BK,MAA9B,EAAsCR,OAAtC;IAAA;;IAAA;MAAA;QAAA;UAAA;YACQC,MADR,GACiB,IAAIR,UAAJ,CAAe;cAC5BgB,IAAI,EAAED,MAAM,CAACC,IADe;cAE5BX,GAAG,EAAE,IAFuB;cAG5BM,MAAM,EAAEI,MAAM,CAACJ,MAHa;cAI5BC,SAAS,EAAEG,MAAM,CAACH,SAJU;cAK5BK,IAAI,EAAEF,MAAM,CAACE,IALe;cAM5BC,KAAK,EAAEH,MAAM,CAACG,KANc;cAO5BC,IAAI,EAAE,KAPsB;cAQ5BC,KAAK,EAAEL,MAAM,CAACK,KARc;cAS5BC,IAAI,EAAEN,MAAM,CAACM;YATe,CAAf,EAUZd,OAVY,CADjB;YAAA;YAAA;YAAA;YAAA,2BAYmCQ,MAAM,CAACO,eAAP,EAZnC;;UAAA;YAAA;YAAA;;UAAA;YAAA;cAAA;cAAA;YAAA;;YAAA,2BAYoBC,GAZpB,eAYoBA,GAZpB,EAYyBnB,KAZzB,eAYyBA,KAZzB;YAAA;YAAA,OAaUI,MAAM,CAACM,GAAP,CAAWS,GAAX,EAAgBnB,KAAhB,CAbV;;UAAA;YAAA;YAAA;YAAA;;UAAA;YAAA;YAAA;;UAAA;YAAA;YAAA;YAAA;YAAA;;UAAA;YAAA;YAAA;;YAAA;cAAA;cAAA;YAAA;;YAAA;YAAA;;UAAA;YAAA;;YAAA;cAAA;cAAA;YAAA;;YAAA;;UAAA;YAAA;;UAAA;YAAA;;UAAA;YAAA,kCAeSI,MAfT;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,C;;;;AAkBAgB,MAAM,CAACC,OAAP,GAAiBtB,WAAjB"},"metadata":{},"sourceType":"script"}