{"ast":null,"code":"var WriteError = require('level-errors').WriteError;\n\nvar promisify = require('./promisify');\n\nvar getCallback = require('./common').getCallback;\n\nvar getOptions = require('./common').getOptions;\n\nfunction Batch(levelup) {\n  // TODO (next major): remove this._levelup alias\n  this.db = this._levelup = levelup;\n  this.batch = levelup.db.batch();\n  this.ops = [];\n  this.length = 0;\n}\n\nBatch.prototype.put = function (key, value) {\n  try {\n    this.batch.put(key, value);\n  } catch (e) {\n    throw new WriteError(e);\n  }\n\n  this.ops.push({\n    type: 'put',\n    key: key,\n    value: value\n  });\n  this.length++;\n  return this;\n};\n\nBatch.prototype.del = function (key) {\n  try {\n    this.batch.del(key);\n  } catch (err) {\n    throw new WriteError(err);\n  }\n\n  this.ops.push({\n    type: 'del',\n    key: key\n  });\n  this.length++;\n  return this;\n};\n\nBatch.prototype.clear = function () {\n  try {\n    this.batch.clear();\n  } catch (err) {\n    throw new WriteError(err);\n  }\n\n  this.ops = [];\n  this.length = 0;\n  return this;\n};\n\nBatch.prototype.write = function (options, callback) {\n  var levelup = this._levelup;\n  var ops = this.ops;\n  var promise;\n  callback = getCallback(options, callback);\n\n  if (!callback) {\n    callback = promisify();\n    promise = callback.promise;\n  }\n\n  options = getOptions(options);\n\n  try {\n    this.batch.write(options, function (err) {\n      if (err) {\n        return callback(new WriteError(err));\n      }\n\n      levelup.emit('batch', ops);\n      callback();\n    });\n  } catch (err) {\n    throw new WriteError(err);\n  }\n\n  return promise;\n};\n\nmodule.exports = Batch;","map":{"version":3,"names":["WriteError","require","promisify","getCallback","getOptions","Batch","levelup","db","_levelup","batch","ops","length","prototype","put","key","value","e","push","type","del","err","clear","write","options","callback","promise","emit","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/orbit-db-keystore/node_modules/level-packager/node_modules/levelup/lib/batch.js"],"sourcesContent":["var WriteError = require('level-errors').WriteError\nvar promisify = require('./promisify')\nvar getCallback = require('./common').getCallback\nvar getOptions = require('./common').getOptions\n\nfunction Batch (levelup) {\n  // TODO (next major): remove this._levelup alias\n  this.db = this._levelup = levelup\n  this.batch = levelup.db.batch()\n  this.ops = []\n  this.length = 0\n}\n\nBatch.prototype.put = function (key, value) {\n  try {\n    this.batch.put(key, value)\n  } catch (e) {\n    throw new WriteError(e)\n  }\n\n  this.ops.push({ type: 'put', key: key, value: value })\n  this.length++\n\n  return this\n}\n\nBatch.prototype.del = function (key) {\n  try {\n    this.batch.del(key)\n  } catch (err) {\n    throw new WriteError(err)\n  }\n\n  this.ops.push({ type: 'del', key: key })\n  this.length++\n\n  return this\n}\n\nBatch.prototype.clear = function () {\n  try {\n    this.batch.clear()\n  } catch (err) {\n    throw new WriteError(err)\n  }\n\n  this.ops = []\n  this.length = 0\n\n  return this\n}\n\nBatch.prototype.write = function (options, callback) {\n  var levelup = this._levelup\n  var ops = this.ops\n  var promise\n\n  callback = getCallback(options, callback)\n\n  if (!callback) {\n    callback = promisify()\n    promise = callback.promise\n  }\n\n  options = getOptions(options)\n\n  try {\n    this.batch.write(options, function (err) {\n      if (err) { return callback(new WriteError(err)) }\n      levelup.emit('batch', ops)\n      callback()\n    })\n  } catch (err) {\n    throw new WriteError(err)\n  }\n\n  return promise\n}\n\nmodule.exports = Batch\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}