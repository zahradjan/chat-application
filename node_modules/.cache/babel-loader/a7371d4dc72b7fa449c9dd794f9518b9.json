{"ast":null,"code":"'use strict';\n\nconst WriteError = require('level-errors').WriteError;\n\nconst catering = require('catering');\n\nconst getCallback = require('./common').getCallback;\n\nconst getOptions = require('./common').getOptions;\n\nfunction Batch(levelup) {\n  this.db = levelup;\n  this.batch = levelup.db.batch();\n  this.ops = [];\n  this.length = 0;\n}\n\nBatch.prototype.put = function (key, value, options) {\n  try {\n    this.batch.put(key, value, options);\n  } catch (e) {\n    throw new WriteError(e);\n  }\n\n  this.ops.push({ ...options,\n    type: 'put',\n    key,\n    value\n  });\n  this.length++;\n  return this;\n};\n\nBatch.prototype.del = function (key, options) {\n  try {\n    this.batch.del(key, options);\n  } catch (err) {\n    throw new WriteError(err);\n  }\n\n  this.ops.push({ ...options,\n    type: 'del',\n    key\n  });\n  this.length++;\n  return this;\n};\n\nBatch.prototype.clear = function () {\n  try {\n    this.batch.clear();\n  } catch (err) {\n    throw new WriteError(err);\n  }\n\n  this.ops = [];\n  this.length = 0;\n  return this;\n};\n\nBatch.prototype.write = function (options, callback) {\n  const levelup = this.db;\n  const ops = this.ops;\n  callback = getCallback(options, callback);\n  callback = catering.fromCallback(callback);\n  options = getOptions(options);\n\n  try {\n    this.batch.write(options, function (err) {\n      if (err) {\n        return callback(new WriteError(err));\n      }\n\n      levelup.emit('batch', ops);\n      callback();\n    });\n  } catch (err) {\n    throw new WriteError(err);\n  }\n\n  return callback.promise;\n};\n\nmodule.exports = Batch;","map":{"version":3,"names":["WriteError","require","catering","getCallback","getOptions","Batch","levelup","db","batch","ops","length","prototype","put","key","value","options","e","push","type","del","err","clear","write","callback","fromCallback","emit","promise","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/levelup/lib/batch.js"],"sourcesContent":["'use strict'\n\nconst WriteError = require('level-errors').WriteError\nconst catering = require('catering')\nconst getCallback = require('./common').getCallback\nconst getOptions = require('./common').getOptions\n\nfunction Batch (levelup) {\n  this.db = levelup\n  this.batch = levelup.db.batch()\n  this.ops = []\n  this.length = 0\n}\n\nBatch.prototype.put = function (key, value, options) {\n  try {\n    this.batch.put(key, value, options)\n  } catch (e) {\n    throw new WriteError(e)\n  }\n\n  this.ops.push({ ...options, type: 'put', key, value })\n  this.length++\n\n  return this\n}\n\nBatch.prototype.del = function (key, options) {\n  try {\n    this.batch.del(key, options)\n  } catch (err) {\n    throw new WriteError(err)\n  }\n\n  this.ops.push({ ...options, type: 'del', key })\n  this.length++\n\n  return this\n}\n\nBatch.prototype.clear = function () {\n  try {\n    this.batch.clear()\n  } catch (err) {\n    throw new WriteError(err)\n  }\n\n  this.ops = []\n  this.length = 0\n\n  return this\n}\n\nBatch.prototype.write = function (options, callback) {\n  const levelup = this.db\n  const ops = this.ops\n\n  callback = getCallback(options, callback)\n  callback = catering.fromCallback(callback)\n  options = getOptions(options)\n\n  try {\n    this.batch.write(options, function (err) {\n      if (err) { return callback(new WriteError(err)) }\n      levelup.emit('batch', ops)\n      callback()\n    })\n  } catch (err) {\n    throw new WriteError(err)\n  }\n\n  return callback.promise\n}\n\nmodule.exports = Batch\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}