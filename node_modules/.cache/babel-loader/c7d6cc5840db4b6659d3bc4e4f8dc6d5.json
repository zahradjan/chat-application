{"ast":null,"code":"// @ts-nocheck\n'use strict';\n\nvar _regeneratorRuntime = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\n\nvar _asyncToGenerator = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\n\nrequire('node-forge/lib/x509');\n\nvar forge = require('node-forge/lib/forge');\n\nvar pki = forge.pki;\n/**\n * Gets a self-signed X.509 certificate for the key.\n *\n * The output Uint8Array contains the PKCS #7 message in DER.\n *\n * TODO: move to libp2p-crypto package\n *\n * @param {KeyInfo} key - The id and name of the key\n * @param {RsaPrivateKey} privateKey - The naked key\n * @returns {Uint8Array}\n */\n\nvar certificateForKey = function certificateForKey(key, privateKey) {\n  var publicKey = pki.setRsaPublicKey(privateKey.n, privateKey.e);\n  var cert = pki.createCertificate();\n  cert.publicKey = publicKey;\n  cert.serialNumber = '01';\n  cert.validity.notBefore = new Date();\n  cert.validity.notAfter = new Date();\n  cert.validity.notAfter.setFullYear(cert.validity.notBefore.getFullYear() + 10);\n  var attrs = [{\n    name: 'organizationName',\n    value: 'ipfs'\n  }, {\n    shortName: 'OU',\n    value: 'keystore'\n  }, {\n    name: 'commonName',\n    value: key.id\n  }];\n  cert.setSubject(attrs);\n  cert.setIssuer(attrs);\n  cert.setExtensions([{\n    name: 'basicConstraints',\n    cA: true\n  }, {\n    name: 'keyUsage',\n    keyCertSign: true,\n    digitalSignature: true,\n    nonRepudiation: true,\n    keyEncipherment: true,\n    dataEncipherment: true\n  }, {\n    name: 'extKeyUsage',\n    serverAuth: true,\n    clientAuth: true,\n    codeSigning: true,\n    emailProtection: true,\n    timeStamping: true\n  }, {\n    name: 'nsCertType',\n    client: true,\n    server: true,\n    email: true,\n    objsign: true,\n    sslCA: true,\n    emailCA: true,\n    objCA: true\n  }]); // self-sign certificate\n\n  cert.sign(privateKey);\n  return cert;\n};\n/**\n * Finds the first item in a collection that is matched in the\n * `asyncCompare` function.\n *\n * `asyncCompare` is an async function that must\n * resolve to either `true` or `false`.\n *\n * @param {Array} array\n * @param {function(*)} asyncCompare - An async function that returns a boolean\n */\n\n\nfunction findAsync(_x, _x2) {\n  return _findAsync.apply(this, arguments);\n}\n\nfunction _findAsync() {\n  _findAsync = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(array, asyncCompare) {\n    var promises, results, index;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            promises = array.map(asyncCompare);\n            _context.next = 3;\n            return Promise.all(promises);\n\n          case 3:\n            results = _context.sent;\n            index = results.findIndex(function (result) {\n              return result;\n            });\n            return _context.abrupt(\"return\", array[index]);\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _findAsync.apply(this, arguments);\n}\n\nmodule.exports = {\n  certificateForKey: certificateForKey,\n  findAsync: findAsync\n};","map":{"version":3,"names":["require","forge","pki","certificateForKey","key","privateKey","publicKey","setRsaPublicKey","n","e","cert","createCertificate","serialNumber","validity","notBefore","Date","notAfter","setFullYear","getFullYear","attrs","name","value","shortName","id","setSubject","setIssuer","setExtensions","cA","keyCertSign","digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","serverAuth","clientAuth","codeSigning","emailProtection","timeStamping","client","server","email","objsign","sslCA","emailCA","objCA","sign","findAsync","array","asyncCompare","promises","map","Promise","all","results","index","findIndex","result","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/libp2p/src/keychain/util.js"],"sourcesContent":["// @ts-nocheck\n'use strict'\n\nrequire('node-forge/lib/x509')\nconst forge = require('node-forge/lib/forge')\nconst pki = forge.pki\n\n/**\n * Gets a self-signed X.509 certificate for the key.\n *\n * The output Uint8Array contains the PKCS #7 message in DER.\n *\n * TODO: move to libp2p-crypto package\n *\n * @param {KeyInfo} key - The id and name of the key\n * @param {RsaPrivateKey} privateKey - The naked key\n * @returns {Uint8Array}\n */\nconst certificateForKey = (key, privateKey) => {\n  const publicKey = pki.setRsaPublicKey(privateKey.n, privateKey.e)\n  const cert = pki.createCertificate()\n  cert.publicKey = publicKey\n  cert.serialNumber = '01'\n  cert.validity.notBefore = new Date()\n  cert.validity.notAfter = new Date()\n  cert.validity.notAfter.setFullYear(cert.validity.notBefore.getFullYear() + 10)\n  const attrs = [{\n    name: 'organizationName',\n    value: 'ipfs'\n  }, {\n    shortName: 'OU',\n    value: 'keystore'\n  }, {\n    name: 'commonName',\n    value: key.id\n  }]\n  cert.setSubject(attrs)\n  cert.setIssuer(attrs)\n  cert.setExtensions([{\n    name: 'basicConstraints',\n    cA: true\n  }, {\n    name: 'keyUsage',\n    keyCertSign: true,\n    digitalSignature: true,\n    nonRepudiation: true,\n    keyEncipherment: true,\n    dataEncipherment: true\n  }, {\n    name: 'extKeyUsage',\n    serverAuth: true,\n    clientAuth: true,\n    codeSigning: true,\n    emailProtection: true,\n    timeStamping: true\n  }, {\n    name: 'nsCertType',\n    client: true,\n    server: true,\n    email: true,\n    objsign: true,\n    sslCA: true,\n    emailCA: true,\n    objCA: true\n  }])\n  // self-sign certificate\n  cert.sign(privateKey)\n\n  return cert\n}\n\n/**\n * Finds the first item in a collection that is matched in the\n * `asyncCompare` function.\n *\n * `asyncCompare` is an async function that must\n * resolve to either `true` or `false`.\n *\n * @param {Array} array\n * @param {function(*)} asyncCompare - An async function that returns a boolean\n */\nasync function findAsync (array, asyncCompare) {\n  const promises = array.map(asyncCompare)\n  const results = await Promise.all(promises)\n  const index = results.findIndex(result => result)\n  return array[index]\n}\n\nmodule.exports = {\n  certificateForKey,\n  findAsync\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}