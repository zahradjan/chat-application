{"ast":null,"code":"'use strict';\n\nconst EC = require('elliptic').ec;\n\nconst ec = new EC('secp256k1');\nmodule.exports = {\n  verify: async (signature, publicKey, data) => {\n    if (!signature) {\n      throw new Error('No signature given');\n    }\n\n    if (!publicKey) {\n      throw new Error('Given publicKey was undefined');\n    }\n\n    if (!data) {\n      throw new Error('Given input data was undefined');\n    }\n\n    let res = false;\n    const key = ec.keyPair({\n      pub: publicKey,\n      pubEnc: 'hex'\n    });\n\n    try {\n      res = ec.verify(data, signature, key);\n    } catch (e) {// Catches 'Error: Signature without r or s'\n    }\n\n    return Promise.resolve(res);\n  }\n};","map":{"version":3,"names":["EC","require","ec","module","exports","verify","signature","publicKey","data","Error","res","key","keyPair","pub","pubEnc","e","Promise","resolve"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/orbit-db-keystore/src/verifiers/verifierv0.js"],"sourcesContent":["'use strict'\n\nconst EC = require('elliptic').ec\nconst ec = new EC('secp256k1')\n\nmodule.exports = {\n  verify: async (signature, publicKey, data) => {\n    if (!signature) {\n      throw new Error('No signature given')\n    }\n    if (!publicKey) {\n      throw new Error('Given publicKey was undefined')\n    }\n    if (!data) {\n      throw new Error('Given input data was undefined')\n    }\n    let res = false\n    const key = ec.keyPair({\n      pub: publicKey,\n      pubEnc: 'hex'\n    })\n    try {\n      res = ec.verify(data, signature, key)\n    } catch (e) {\n      // Catches 'Error: Signature without r or s'\n    }\n    return Promise.resolve(res)\n  }\n}\n"],"mappings":"AAAA;;AAEA,MAAMA,EAAE,GAAGC,OAAO,CAAC,UAAD,CAAP,CAAoBC,EAA/B;;AACA,MAAMA,EAAE,GAAG,IAAIF,EAAJ,CAAO,WAAP,CAAX;AAEAG,MAAM,CAACC,OAAP,GAAiB;EACfC,MAAM,EAAE,OAAOC,SAAP,EAAkBC,SAAlB,EAA6BC,IAA7B,KAAsC;IAC5C,IAAI,CAACF,SAAL,EAAgB;MACd,MAAM,IAAIG,KAAJ,CAAU,oBAAV,CAAN;IACD;;IACD,IAAI,CAACF,SAAL,EAAgB;MACd,MAAM,IAAIE,KAAJ,CAAU,+BAAV,CAAN;IACD;;IACD,IAAI,CAACD,IAAL,EAAW;MACT,MAAM,IAAIC,KAAJ,CAAU,gCAAV,CAAN;IACD;;IACD,IAAIC,GAAG,GAAG,KAAV;IACA,MAAMC,GAAG,GAAGT,EAAE,CAACU,OAAH,CAAW;MACrBC,GAAG,EAAEN,SADgB;MAErBO,MAAM,EAAE;IAFa,CAAX,CAAZ;;IAIA,IAAI;MACFJ,GAAG,GAAGR,EAAE,CAACG,MAAH,CAAUG,IAAV,EAAgBF,SAAhB,EAA2BK,GAA3B,CAAN;IACD,CAFD,CAEE,OAAOI,CAAP,EAAU,CACV;IACD;;IACD,OAAOC,OAAO,CAACC,OAAR,CAAgBP,GAAhB,CAAP;EACD;AAtBc,CAAjB"},"metadata":{},"sourceType":"script"}