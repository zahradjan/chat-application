{"ast":null,"code":"'use strict';\n\nconst MAX_MSG_SIZE = 1 << 20; // 1MB\n\n/**\n * Creates an iterable transform that restricts message sizes to\n * the given maximum size.\n *\n * @param {number} [max] - The maximum message size. Defaults to 1MB\n * @returns {*} An iterable transform.\n */\n\nmodule.exports = max => {\n  max = max || MAX_MSG_SIZE;\n\n  const checkSize = msg => {\n    if (msg.data && msg.data.length > max) {\n      throw Object.assign(new Error('message size too large!'), {\n        code: 'ERR_MSG_TOO_BIG'\n      });\n    }\n  };\n\n  return source => {\n    return async function* restrictSize() {\n      for await (const msg of source) {\n        if (Array.isArray(msg)) {\n          msg.forEach(checkSize);\n        } else {\n          checkSize(msg);\n        }\n\n        yield msg;\n      }\n    }();\n  };\n};\n\nmodule.exports.MAX_MSG_SIZE = MAX_MSG_SIZE;","map":{"version":3,"names":["MAX_MSG_SIZE","module","exports","max","checkSize","msg","data","length","Object","assign","Error","code","source","restrictSize","Array","isArray","forEach"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/libp2p-mplex/src/restrict-size.js"],"sourcesContent":["'use strict'\n\nconst MAX_MSG_SIZE = 1 << 20 // 1MB\n\n/**\n * Creates an iterable transform that restricts message sizes to\n * the given maximum size.\n *\n * @param {number} [max] - The maximum message size. Defaults to 1MB\n * @returns {*} An iterable transform.\n */\nmodule.exports = max => {\n  max = max || MAX_MSG_SIZE\n\n  const checkSize = msg => {\n    if (msg.data && msg.data.length > max) {\n      throw Object.assign(new Error('message size too large!'), { code: 'ERR_MSG_TOO_BIG' })\n    }\n  }\n\n  return source => {\n    return (async function * restrictSize () {\n      for await (const msg of source) {\n        if (Array.isArray(msg)) {\n          msg.forEach(checkSize)\n        } else {\n          checkSize(msg)\n        }\n        yield msg\n      }\n    })()\n  }\n}\n\nmodule.exports.MAX_MSG_SIZE = MAX_MSG_SIZE\n"],"mappings":"AAAA;;AAEA,MAAMA,YAAY,GAAG,KAAK,EAA1B,C,CAA6B;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;;AACAC,MAAM,CAACC,OAAP,GAAiBC,GAAG,IAAI;EACtBA,GAAG,GAAGA,GAAG,IAAIH,YAAb;;EAEA,MAAMI,SAAS,GAAGC,GAAG,IAAI;IACvB,IAAIA,GAAG,CAACC,IAAJ,IAAYD,GAAG,CAACC,IAAJ,CAASC,MAAT,GAAkBJ,GAAlC,EAAuC;MACrC,MAAMK,MAAM,CAACC,MAAP,CAAc,IAAIC,KAAJ,CAAU,yBAAV,CAAd,EAAoD;QAAEC,IAAI,EAAE;MAAR,CAApD,CAAN;IACD;EACF,CAJD;;EAMA,OAAOC,MAAM,IAAI;IACf,OAAQ,gBAAiBC,YAAjB,GAAiC;MACvC,WAAW,MAAMR,GAAjB,IAAwBO,MAAxB,EAAgC;QAC9B,IAAIE,KAAK,CAACC,OAAN,CAAcV,GAAd,CAAJ,EAAwB;UACtBA,GAAG,CAACW,OAAJ,CAAYZ,SAAZ;QACD,CAFD,MAEO;UACLA,SAAS,CAACC,GAAD,CAAT;QACD;;QACD,MAAMA,GAAN;MACD;IACF,CATM,EAAP;EAUD,CAXD;AAYD,CArBD;;AAuBAJ,MAAM,CAACC,OAAP,CAAeF,YAAf,GAA8BA,YAA9B"},"metadata":{},"sourceType":"script"}