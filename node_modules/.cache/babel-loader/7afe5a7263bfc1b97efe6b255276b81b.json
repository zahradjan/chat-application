{"ast":null,"code":"'use strict';\n\nconst errcode = require('err-code');\n\nconst {\n  equals: uint8ArrayEquals\n} = require('uint8arrays/equals');\n\nconst {\n  sha256\n} = require('multiformats/hashes/sha2');\n\nconst {\n  base58btc\n} = require('multiformats/bases/base58');\n\nconst {\n  identity\n} = require('multiformats/hashes/identity');\n\nconst crypto = require('./ed25519');\n\nconst pbm = require('./keys');\n\nconst exporter = require('./exporter');\n\nclass Ed25519PublicKey {\n  constructor(key) {\n    this._key = ensureKey(key, crypto.publicKeyLength);\n  }\n\n  async verify(data, sig) {\n    // eslint-disable-line require-await\n    return crypto.hashAndVerify(this._key, sig, data);\n  }\n\n  marshal() {\n    return this._key;\n  }\n\n  get bytes() {\n    return pbm.PublicKey.encode({\n      Type: pbm.KeyType.Ed25519,\n      Data: this.marshal()\n    }).finish();\n  }\n\n  equals(key) {\n    return uint8ArrayEquals(this.bytes, key.bytes);\n  }\n\n  async hash() {\n    const {\n      bytes\n    } = await sha256.digest(this.bytes);\n    return bytes;\n  }\n\n}\n\nclass Ed25519PrivateKey {\n  // key       - 64 byte Uint8Array containing private key\n  // publicKey - 32 byte Uint8Array containing public key\n  constructor(key, publicKey) {\n    this._key = ensureKey(key, crypto.privateKeyLength);\n    this._publicKey = ensureKey(publicKey, crypto.publicKeyLength);\n  }\n\n  async sign(message) {\n    // eslint-disable-line require-await\n    return crypto.hashAndSign(this._key, message);\n  }\n\n  get public() {\n    return new Ed25519PublicKey(this._publicKey);\n  }\n\n  marshal() {\n    return this._key;\n  }\n\n  get bytes() {\n    return pbm.PrivateKey.encode({\n      Type: pbm.KeyType.Ed25519,\n      Data: this.marshal()\n    }).finish();\n  }\n\n  equals(key) {\n    return uint8ArrayEquals(this.bytes, key.bytes);\n  }\n\n  async hash() {\n    const {\n      bytes\n    } = await sha256.digest(this.bytes);\n    return bytes;\n  }\n  /**\n   * Gets the ID of the key.\n   *\n   * The key id is the base58 encoding of the identity multihash containing its public key.\n   * The public key is a protobuf encoding containing a type and the DER encoding\n   * of the PKCS SubjectPublicKeyInfo.\n   *\n   * @returns {Promise<string>}\n   */\n\n\n  async id() {\n    const encoding = await identity.digest(this.public.bytes);\n    return base58btc.encode(encoding.bytes).substring(1);\n  }\n  /**\n   * Exports the key into a password protected `format`\n   *\n   * @param {string} password - The password to encrypt the key\n   * @param {string} [format=libp2p-key] - The format in which to export as\n   * @returns {Promise<Uint8Array>} The encrypted private key\n   */\n\n\n  async export(password) {\n    let format = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'libp2p-key';\n\n    // eslint-disable-line require-await\n    if (format === 'libp2p-key') {\n      return exporter.export(this.bytes, password);\n    } else {\n      throw errcode(new Error(`export format '${format}' is not supported`), 'ERR_INVALID_EXPORT_FORMAT');\n    }\n  }\n\n}\n\nfunction unmarshalEd25519PrivateKey(bytes) {\n  // Try the old, redundant public key version\n  if (bytes.length > crypto.privateKeyLength) {\n    bytes = ensureKey(bytes, crypto.privateKeyLength + crypto.publicKeyLength);\n    const privateKeyBytes = bytes.slice(0, crypto.privateKeyLength);\n    const publicKeyBytes = bytes.slice(crypto.privateKeyLength, bytes.length);\n    return new Ed25519PrivateKey(privateKeyBytes, publicKeyBytes);\n  }\n\n  bytes = ensureKey(bytes, crypto.privateKeyLength);\n  const privateKeyBytes = bytes.slice(0, crypto.privateKeyLength);\n  const publicKeyBytes = bytes.slice(crypto.publicKeyLength);\n  return new Ed25519PrivateKey(privateKeyBytes, publicKeyBytes);\n}\n\nfunction unmarshalEd25519PublicKey(bytes) {\n  bytes = ensureKey(bytes, crypto.publicKeyLength);\n  return new Ed25519PublicKey(bytes);\n}\n\nasync function generateKeyPair() {\n  const {\n    privateKey,\n    publicKey\n  } = await crypto.generateKey();\n  return new Ed25519PrivateKey(privateKey, publicKey);\n}\n\nasync function generateKeyPairFromSeed(seed) {\n  const {\n    privateKey,\n    publicKey\n  } = await crypto.generateKeyFromSeed(seed);\n  return new Ed25519PrivateKey(privateKey, publicKey);\n}\n\nfunction ensureKey(key, length) {\n  key = Uint8Array.from(key || []);\n\n  if (key.length !== length) {\n    throw errcode(new Error(`Key must be a Uint8Array of length ${length}, got ${key.length}`), 'ERR_INVALID_KEY_TYPE');\n  }\n\n  return key;\n}\n\nmodule.exports = {\n  Ed25519PublicKey,\n  Ed25519PrivateKey,\n  unmarshalEd25519PrivateKey,\n  unmarshalEd25519PublicKey,\n  generateKeyPair,\n  generateKeyPairFromSeed\n};","map":{"version":3,"names":["errcode","require","equals","uint8ArrayEquals","sha256","base58btc","identity","crypto","pbm","exporter","Ed25519PublicKey","constructor","key","_key","ensureKey","publicKeyLength","verify","data","sig","hashAndVerify","marshal","bytes","PublicKey","encode","Type","KeyType","Ed25519","Data","finish","hash","digest","Ed25519PrivateKey","publicKey","privateKeyLength","_publicKey","sign","message","hashAndSign","public","PrivateKey","id","encoding","substring","export","password","format","Error","unmarshalEd25519PrivateKey","length","privateKeyBytes","slice","publicKeyBytes","unmarshalEd25519PublicKey","generateKeyPair","privateKey","generateKey","generateKeyPairFromSeed","seed","generateKeyFromSeed","Uint8Array","from","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/libp2p-delegated-content-routing/node_modules/libp2p-crypto/src/keys/ed25519-class.js"],"sourcesContent":["'use strict'\n\nconst errcode = require('err-code')\nconst { equals: uint8ArrayEquals } = require('uint8arrays/equals')\nconst { sha256 } = require('multiformats/hashes/sha2')\nconst { base58btc } = require('multiformats/bases/base58')\nconst { identity } = require('multiformats/hashes/identity')\nconst crypto = require('./ed25519')\nconst pbm = require('./keys')\nconst exporter = require('./exporter')\n\nclass Ed25519PublicKey {\n  constructor (key) {\n    this._key = ensureKey(key, crypto.publicKeyLength)\n  }\n\n  async verify (data, sig) { // eslint-disable-line require-await\n    return crypto.hashAndVerify(this._key, sig, data)\n  }\n\n  marshal () {\n    return this._key\n  }\n\n  get bytes () {\n    return pbm.PublicKey.encode({\n      Type: pbm.KeyType.Ed25519,\n      Data: this.marshal()\n    }).finish()\n  }\n\n  equals (key) {\n    return uint8ArrayEquals(this.bytes, key.bytes)\n  }\n\n  async hash () {\n    const { bytes } = await sha256.digest(this.bytes)\n\n    return bytes\n  }\n}\n\nclass Ed25519PrivateKey {\n  // key       - 64 byte Uint8Array containing private key\n  // publicKey - 32 byte Uint8Array containing public key\n  constructor (key, publicKey) {\n    this._key = ensureKey(key, crypto.privateKeyLength)\n    this._publicKey = ensureKey(publicKey, crypto.publicKeyLength)\n  }\n\n  async sign (message) { // eslint-disable-line require-await\n    return crypto.hashAndSign(this._key, message)\n  }\n\n  get public () {\n    return new Ed25519PublicKey(this._publicKey)\n  }\n\n  marshal () {\n    return this._key\n  }\n\n  get bytes () {\n    return pbm.PrivateKey.encode({\n      Type: pbm.KeyType.Ed25519,\n      Data: this.marshal()\n    }).finish()\n  }\n\n  equals (key) {\n    return uint8ArrayEquals(this.bytes, key.bytes)\n  }\n\n  async hash () {\n    const { bytes } = await sha256.digest(this.bytes)\n\n    return bytes\n  }\n\n  /**\n   * Gets the ID of the key.\n   *\n   * The key id is the base58 encoding of the identity multihash containing its public key.\n   * The public key is a protobuf encoding containing a type and the DER encoding\n   * of the PKCS SubjectPublicKeyInfo.\n   *\n   * @returns {Promise<string>}\n   */\n  async id () {\n    const encoding = await identity.digest(this.public.bytes)\n    return base58btc.encode(encoding.bytes).substring(1)\n  }\n\n  /**\n   * Exports the key into a password protected `format`\n   *\n   * @param {string} password - The password to encrypt the key\n   * @param {string} [format=libp2p-key] - The format in which to export as\n   * @returns {Promise<Uint8Array>} The encrypted private key\n   */\n  async export (password, format = 'libp2p-key') { // eslint-disable-line require-await\n    if (format === 'libp2p-key') {\n      return exporter.export(this.bytes, password)\n    } else {\n      throw errcode(new Error(`export format '${format}' is not supported`), 'ERR_INVALID_EXPORT_FORMAT')\n    }\n  }\n}\n\nfunction unmarshalEd25519PrivateKey (bytes) {\n  // Try the old, redundant public key version\n  if (bytes.length > crypto.privateKeyLength) {\n    bytes = ensureKey(bytes, crypto.privateKeyLength + crypto.publicKeyLength)\n    const privateKeyBytes = bytes.slice(0, crypto.privateKeyLength)\n    const publicKeyBytes = bytes.slice(crypto.privateKeyLength, bytes.length)\n    return new Ed25519PrivateKey(privateKeyBytes, publicKeyBytes)\n  }\n\n  bytes = ensureKey(bytes, crypto.privateKeyLength)\n  const privateKeyBytes = bytes.slice(0, crypto.privateKeyLength)\n  const publicKeyBytes = bytes.slice(crypto.publicKeyLength)\n  return new Ed25519PrivateKey(privateKeyBytes, publicKeyBytes)\n}\n\nfunction unmarshalEd25519PublicKey (bytes) {\n  bytes = ensureKey(bytes, crypto.publicKeyLength)\n  return new Ed25519PublicKey(bytes)\n}\n\nasync function generateKeyPair () {\n  const { privateKey, publicKey } = await crypto.generateKey()\n  return new Ed25519PrivateKey(privateKey, publicKey)\n}\n\nasync function generateKeyPairFromSeed (seed) {\n  const { privateKey, publicKey } = await crypto.generateKeyFromSeed(seed)\n  return new Ed25519PrivateKey(privateKey, publicKey)\n}\n\nfunction ensureKey (key, length) {\n  key = Uint8Array.from(key || [])\n  if (key.length !== length) {\n    throw errcode(new Error(`Key must be a Uint8Array of length ${length}, got ${key.length}`), 'ERR_INVALID_KEY_TYPE')\n  }\n  return key\n}\n\nmodule.exports = {\n  Ed25519PublicKey,\n  Ed25519PrivateKey,\n  unmarshalEd25519PrivateKey,\n  unmarshalEd25519PublicKey,\n  generateKeyPair,\n  generateKeyPairFromSeed\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}