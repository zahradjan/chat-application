{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction noop() {}\n\nfunction create() {\n  const chunkQueue = [];\n  let drainer = null;\n  let drainerResolver = noop;\n  let ended = false;\n  let outWait = null;\n  let outWaitResolver = noop;\n\n  const makeDrainer = () => {\n    if (!drainer) {\n      drainer = new Promise(resolve => {\n        drainerResolver = () => {\n          drainer = null;\n          drainerResolver = noop;\n          resolve();\n        };\n      });\n    }\n\n    return drainer;\n  };\n\n  const writer = {\n    write(chunk) {\n      chunkQueue.push(chunk);\n      const drainer = makeDrainer();\n      outWaitResolver();\n      return drainer;\n    },\n\n    async end() {\n      ended = true;\n      const drainer = makeDrainer();\n      outWaitResolver();\n      return drainer;\n    }\n\n  };\n  const iterator = {\n    async next() {\n      const chunk = chunkQueue.shift();\n\n      if (chunk) {\n        if (chunkQueue.length === 0) {\n          drainerResolver();\n        }\n\n        return {\n          done: false,\n          value: chunk\n        };\n      }\n\n      if (ended) {\n        drainerResolver();\n        return {\n          done: true,\n          value: undefined\n        };\n      }\n\n      if (!outWait) {\n        outWait = new Promise(resolve => {\n          outWaitResolver = () => {\n            outWait = null;\n            outWaitResolver = noop;\n            return resolve(iterator.next());\n          };\n        });\n      }\n\n      return outWait;\n    }\n\n  };\n  return {\n    writer,\n    iterator\n  };\n}\n\nexports.create = create;","map":{"version":3,"names":["Object","defineProperty","exports","value","noop","create","chunkQueue","drainer","drainerResolver","ended","outWait","outWaitResolver","makeDrainer","Promise","resolve","writer","write","chunk","push","end","iterator","next","shift","length","done","undefined"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/@ipld/car/cjs/lib/iterator-channel.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nfunction noop() {\n}\nfunction create() {\n  const chunkQueue = [];\n  let drainer = null;\n  let drainerResolver = noop;\n  let ended = false;\n  let outWait = null;\n  let outWaitResolver = noop;\n  const makeDrainer = () => {\n    if (!drainer) {\n      drainer = new Promise(resolve => {\n        drainerResolver = () => {\n          drainer = null;\n          drainerResolver = noop;\n          resolve();\n        };\n      });\n    }\n    return drainer;\n  };\n  const writer = {\n    write(chunk) {\n      chunkQueue.push(chunk);\n      const drainer = makeDrainer();\n      outWaitResolver();\n      return drainer;\n    },\n    async end() {\n      ended = true;\n      const drainer = makeDrainer();\n      outWaitResolver();\n      return drainer;\n    }\n  };\n  const iterator = {\n    async next() {\n      const chunk = chunkQueue.shift();\n      if (chunk) {\n        if (chunkQueue.length === 0) {\n          drainerResolver();\n        }\n        return {\n          done: false,\n          value: chunk\n        };\n      }\n      if (ended) {\n        drainerResolver();\n        return {\n          done: true,\n          value: undefined\n        };\n      }\n      if (!outWait) {\n        outWait = new Promise(resolve => {\n          outWaitResolver = () => {\n            outWait = null;\n            outWaitResolver = noop;\n            return resolve(iterator.next());\n          };\n        });\n      }\n      return outWait;\n    }\n  };\n  return {\n    writer,\n    iterator\n  };\n}\n\nexports.create = create;\n"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;EAAEC,KAAK,EAAE;AAAT,CAA7C;;AAEA,SAASC,IAAT,GAAgB,CACf;;AACD,SAASC,MAAT,GAAkB;EAChB,MAAMC,UAAU,GAAG,EAAnB;EACA,IAAIC,OAAO,GAAG,IAAd;EACA,IAAIC,eAAe,GAAGJ,IAAtB;EACA,IAAIK,KAAK,GAAG,KAAZ;EACA,IAAIC,OAAO,GAAG,IAAd;EACA,IAAIC,eAAe,GAAGP,IAAtB;;EACA,MAAMQ,WAAW,GAAG,MAAM;IACxB,IAAI,CAACL,OAAL,EAAc;MACZA,OAAO,GAAG,IAAIM,OAAJ,CAAYC,OAAO,IAAI;QAC/BN,eAAe,GAAG,MAAM;UACtBD,OAAO,GAAG,IAAV;UACAC,eAAe,GAAGJ,IAAlB;UACAU,OAAO;QACR,CAJD;MAKD,CANS,CAAV;IAOD;;IACD,OAAOP,OAAP;EACD,CAXD;;EAYA,MAAMQ,MAAM,GAAG;IACbC,KAAK,CAACC,KAAD,EAAQ;MACXX,UAAU,CAACY,IAAX,CAAgBD,KAAhB;MACA,MAAMV,OAAO,GAAGK,WAAW,EAA3B;MACAD,eAAe;MACf,OAAOJ,OAAP;IACD,CANY;;IAOb,MAAMY,GAAN,GAAY;MACVV,KAAK,GAAG,IAAR;MACA,MAAMF,OAAO,GAAGK,WAAW,EAA3B;MACAD,eAAe;MACf,OAAOJ,OAAP;IACD;;EAZY,CAAf;EAcA,MAAMa,QAAQ,GAAG;IACf,MAAMC,IAAN,GAAa;MACX,MAAMJ,KAAK,GAAGX,UAAU,CAACgB,KAAX,EAAd;;MACA,IAAIL,KAAJ,EAAW;QACT,IAAIX,UAAU,CAACiB,MAAX,KAAsB,CAA1B,EAA6B;UAC3Bf,eAAe;QAChB;;QACD,OAAO;UACLgB,IAAI,EAAE,KADD;UAELrB,KAAK,EAAEc;QAFF,CAAP;MAID;;MACD,IAAIR,KAAJ,EAAW;QACTD,eAAe;QACf,OAAO;UACLgB,IAAI,EAAE,IADD;UAELrB,KAAK,EAAEsB;QAFF,CAAP;MAID;;MACD,IAAI,CAACf,OAAL,EAAc;QACZA,OAAO,GAAG,IAAIG,OAAJ,CAAYC,OAAO,IAAI;UAC/BH,eAAe,GAAG,MAAM;YACtBD,OAAO,GAAG,IAAV;YACAC,eAAe,GAAGP,IAAlB;YACA,OAAOU,OAAO,CAACM,QAAQ,CAACC,IAAT,EAAD,CAAd;UACD,CAJD;QAKD,CANS,CAAV;MAOD;;MACD,OAAOX,OAAP;IACD;;EA7Bc,CAAjB;EA+BA,OAAO;IACLK,MADK;IAELK;EAFK,CAAP;AAID;;AAEDlB,OAAO,CAACG,MAAR,GAAiBA,MAAjB"},"metadata":{},"sourceType":"script"}