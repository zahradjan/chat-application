{"ast":null,"code":"/* eslint consistent-this: 0 */\n// Timeout cached values\n\"use strict\";\n\nvar aFrom = require(\"es5-ext/array/from\"),\n    forEach = require(\"es5-ext/object/for-each\"),\n    nextTick = require(\"next-tick\"),\n    isPromise = require(\"is-promise\"),\n    timeout = require(\"timers-ext/valid-timeout\"),\n    extensions = require(\"../lib/registered-extensions\");\n\nvar noop = Function.prototype,\n    max = Math.max,\n    min = Math.min,\n    create = Object.create;\n\nextensions.maxAge = function (maxAge, conf, options) {\n  var timeouts, postfix, preFetchAge, preFetchTimeouts;\n  maxAge = timeout(maxAge);\n  if (!maxAge) return;\n  timeouts = create(null);\n  postfix = options.async && extensions.async || options.promise && extensions.promise ? \"async\" : \"\";\n  conf.on(\"set\" + postfix, function (id) {\n    timeouts[id] = setTimeout(function () {\n      conf.delete(id);\n    }, maxAge);\n    if (typeof timeouts[id].unref === \"function\") timeouts[id].unref();\n    if (!preFetchTimeouts) return;\n\n    if (preFetchTimeouts[id]) {\n      if (preFetchTimeouts[id] !== \"nextTick\") clearTimeout(preFetchTimeouts[id]);\n    }\n\n    preFetchTimeouts[id] = setTimeout(function () {\n      delete preFetchTimeouts[id];\n    }, preFetchAge);\n    if (typeof preFetchTimeouts[id].unref === \"function\") preFetchTimeouts[id].unref();\n  });\n  conf.on(\"delete\" + postfix, function (id) {\n    clearTimeout(timeouts[id]);\n    delete timeouts[id];\n    if (!preFetchTimeouts) return;\n    if (preFetchTimeouts[id] !== \"nextTick\") clearTimeout(preFetchTimeouts[id]);\n    delete preFetchTimeouts[id];\n  });\n\n  if (options.preFetch) {\n    if (options.preFetch === true || isNaN(options.preFetch)) {\n      preFetchAge = 0.333;\n    } else {\n      preFetchAge = max(min(Number(options.preFetch), 1), 0);\n    }\n\n    if (preFetchAge) {\n      preFetchTimeouts = {};\n      preFetchAge = (1 - preFetchAge) * maxAge;\n      conf.on(\"get\" + postfix, function (id, args, context) {\n        if (!preFetchTimeouts[id]) {\n          preFetchTimeouts[id] = \"nextTick\";\n          nextTick(function () {\n            var result;\n            if (preFetchTimeouts[id] !== \"nextTick\") return;\n            delete preFetchTimeouts[id];\n            conf.delete(id);\n\n            if (options.async) {\n              args = aFrom(args);\n              args.push(noop);\n            }\n\n            result = conf.memoized.apply(context, args);\n\n            if (options.promise) {\n              // Supress eventual error warnings\n              if (isPromise(result)) {\n                if (typeof result.done === \"function\") result.done(noop, noop);else result.then(noop, noop);\n              }\n            }\n          });\n        }\n      });\n    }\n  }\n\n  conf.on(\"clear\" + postfix, function () {\n    forEach(timeouts, function (id) {\n      clearTimeout(id);\n    });\n    timeouts = {};\n\n    if (preFetchTimeouts) {\n      forEach(preFetchTimeouts, function (id) {\n        if (id !== \"nextTick\") clearTimeout(id);\n      });\n      preFetchTimeouts = {};\n    }\n  });\n};","map":{"version":3,"names":["aFrom","require","forEach","nextTick","isPromise","timeout","extensions","noop","Function","prototype","max","Math","min","create","Object","maxAge","conf","options","timeouts","postfix","preFetchAge","preFetchTimeouts","async","promise","on","id","setTimeout","delete","unref","clearTimeout","preFetch","isNaN","Number","args","context","result","push","memoized","apply","done","then"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/memoizee/ext/max-age.js"],"sourcesContent":["/* eslint consistent-this: 0 */\n\n// Timeout cached values\n\n\"use strict\";\n\nvar aFrom      = require(\"es5-ext/array/from\")\n  , forEach    = require(\"es5-ext/object/for-each\")\n  , nextTick   = require(\"next-tick\")\n  , isPromise  = require(\"is-promise\")\n  , timeout    = require(\"timers-ext/valid-timeout\")\n  , extensions = require(\"../lib/registered-extensions\");\n\nvar noop = Function.prototype, max = Math.max, min = Math.min, create = Object.create;\n\nextensions.maxAge = function (maxAge, conf, options) {\n\tvar timeouts, postfix, preFetchAge, preFetchTimeouts;\n\n\tmaxAge = timeout(maxAge);\n\tif (!maxAge) return;\n\n\ttimeouts = create(null);\n\tpostfix =\n\t\t(options.async && extensions.async) || (options.promise && extensions.promise)\n\t\t\t? \"async\"\n\t\t\t: \"\";\n\tconf.on(\"set\" + postfix, function (id) {\n\t\ttimeouts[id] = setTimeout(function () { conf.delete(id); }, maxAge);\n\t\tif (typeof timeouts[id].unref === \"function\") timeouts[id].unref();\n\t\tif (!preFetchTimeouts) return;\n\t\tif (preFetchTimeouts[id]) {\n\t\t\tif (preFetchTimeouts[id] !== \"nextTick\") clearTimeout(preFetchTimeouts[id]);\n\t\t}\n\t\tpreFetchTimeouts[id] = setTimeout(function () {\n\t\t\tdelete preFetchTimeouts[id];\n\t\t}, preFetchAge);\n\t\tif (typeof preFetchTimeouts[id].unref === \"function\") preFetchTimeouts[id].unref();\n\t});\n\tconf.on(\"delete\" + postfix, function (id) {\n\t\tclearTimeout(timeouts[id]);\n\t\tdelete timeouts[id];\n\t\tif (!preFetchTimeouts) return;\n\t\tif (preFetchTimeouts[id] !== \"nextTick\") clearTimeout(preFetchTimeouts[id]);\n\t\tdelete preFetchTimeouts[id];\n\t});\n\n\tif (options.preFetch) {\n\t\tif (options.preFetch === true || isNaN(options.preFetch)) {\n\t\t\tpreFetchAge = 0.333;\n\t\t} else {\n\t\t\tpreFetchAge = max(min(Number(options.preFetch), 1), 0);\n\t\t}\n\t\tif (preFetchAge) {\n\t\t\tpreFetchTimeouts = {};\n\t\t\tpreFetchAge = (1 - preFetchAge) * maxAge;\n\t\t\tconf.on(\"get\" + postfix, function (id, args, context) {\n\t\t\t\tif (!preFetchTimeouts[id]) {\n\t\t\t\t\tpreFetchTimeouts[id] = \"nextTick\";\n\t\t\t\t\tnextTick(function () {\n\t\t\t\t\t\tvar result;\n\t\t\t\t\t\tif (preFetchTimeouts[id] !== \"nextTick\") return;\n\t\t\t\t\t\tdelete preFetchTimeouts[id];\n\t\t\t\t\t\tconf.delete(id);\n\t\t\t\t\t\tif (options.async) {\n\t\t\t\t\t\t\targs = aFrom(args);\n\t\t\t\t\t\t\targs.push(noop);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult = conf.memoized.apply(context, args);\n\t\t\t\t\t\tif (options.promise) {\n\t\t\t\t\t\t\t// Supress eventual error warnings\n\t\t\t\t\t\t\tif (isPromise(result)) {\n\t\t\t\t\t\t\t\tif (typeof result.done === \"function\") result.done(noop, noop);\n\t\t\t\t\t\t\t\telse result.then(noop, noop);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tconf.on(\"clear\" + postfix, function () {\n\t\tforEach(timeouts, function (id) { clearTimeout(id); });\n\t\ttimeouts = {};\n\t\tif (preFetchTimeouts) {\n\t\t\tforEach(preFetchTimeouts, function (id) { if (id !== \"nextTick\") clearTimeout(id); });\n\t\t\tpreFetchTimeouts = {};\n\t\t}\n\t});\n};\n"],"mappings":"AAAA;AAEA;AAEA;;AAEA,IAAIA,KAAK,GAAQC,OAAO,CAAC,oBAAD,CAAxB;AAAA,IACIC,OAAO,GAAMD,OAAO,CAAC,yBAAD,CADxB;AAAA,IAEIE,QAAQ,GAAKF,OAAO,CAAC,WAAD,CAFxB;AAAA,IAGIG,SAAS,GAAIH,OAAO,CAAC,YAAD,CAHxB;AAAA,IAIII,OAAO,GAAMJ,OAAO,CAAC,0BAAD,CAJxB;AAAA,IAKIK,UAAU,GAAGL,OAAO,CAAC,8BAAD,CALxB;;AAOA,IAAIM,IAAI,GAAGC,QAAQ,CAACC,SAApB;AAAA,IAA+BC,GAAG,GAAGC,IAAI,CAACD,GAA1C;AAAA,IAA+CE,GAAG,GAAGD,IAAI,CAACC,GAA1D;AAAA,IAA+DC,MAAM,GAAGC,MAAM,CAACD,MAA/E;;AAEAP,UAAU,CAACS,MAAX,GAAoB,UAAUA,MAAV,EAAkBC,IAAlB,EAAwBC,OAAxB,EAAiC;EACpD,IAAIC,QAAJ,EAAcC,OAAd,EAAuBC,WAAvB,EAAoCC,gBAApC;EAEAN,MAAM,GAAGV,OAAO,CAACU,MAAD,CAAhB;EACA,IAAI,CAACA,MAAL,EAAa;EAEbG,QAAQ,GAAGL,MAAM,CAAC,IAAD,CAAjB;EACAM,OAAO,GACLF,OAAO,CAACK,KAAR,IAAiBhB,UAAU,CAACgB,KAA7B,IAAwCL,OAAO,CAACM,OAAR,IAAmBjB,UAAU,CAACiB,OAAtE,GACG,OADH,GAEG,EAHJ;EAIAP,IAAI,CAACQ,EAAL,CAAQ,QAAQL,OAAhB,EAAyB,UAAUM,EAAV,EAAc;IACtCP,QAAQ,CAACO,EAAD,CAAR,GAAeC,UAAU,CAAC,YAAY;MAAEV,IAAI,CAACW,MAAL,CAAYF,EAAZ;IAAkB,CAAjC,EAAmCV,MAAnC,CAAzB;IACA,IAAI,OAAOG,QAAQ,CAACO,EAAD,CAAR,CAAaG,KAApB,KAA8B,UAAlC,EAA8CV,QAAQ,CAACO,EAAD,CAAR,CAAaG,KAAb;IAC9C,IAAI,CAACP,gBAAL,EAAuB;;IACvB,IAAIA,gBAAgB,CAACI,EAAD,CAApB,EAA0B;MACzB,IAAIJ,gBAAgB,CAACI,EAAD,CAAhB,KAAyB,UAA7B,EAAyCI,YAAY,CAACR,gBAAgB,CAACI,EAAD,CAAjB,CAAZ;IACzC;;IACDJ,gBAAgB,CAACI,EAAD,CAAhB,GAAuBC,UAAU,CAAC,YAAY;MAC7C,OAAOL,gBAAgB,CAACI,EAAD,CAAvB;IACA,CAFgC,EAE9BL,WAF8B,CAAjC;IAGA,IAAI,OAAOC,gBAAgB,CAACI,EAAD,CAAhB,CAAqBG,KAA5B,KAAsC,UAA1C,EAAsDP,gBAAgB,CAACI,EAAD,CAAhB,CAAqBG,KAArB;EACtD,CAXD;EAYAZ,IAAI,CAACQ,EAAL,CAAQ,WAAWL,OAAnB,EAA4B,UAAUM,EAAV,EAAc;IACzCI,YAAY,CAACX,QAAQ,CAACO,EAAD,CAAT,CAAZ;IACA,OAAOP,QAAQ,CAACO,EAAD,CAAf;IACA,IAAI,CAACJ,gBAAL,EAAuB;IACvB,IAAIA,gBAAgB,CAACI,EAAD,CAAhB,KAAyB,UAA7B,EAAyCI,YAAY,CAACR,gBAAgB,CAACI,EAAD,CAAjB,CAAZ;IACzC,OAAOJ,gBAAgB,CAACI,EAAD,CAAvB;EACA,CAND;;EAQA,IAAIR,OAAO,CAACa,QAAZ,EAAsB;IACrB,IAAIb,OAAO,CAACa,QAAR,KAAqB,IAArB,IAA6BC,KAAK,CAACd,OAAO,CAACa,QAAT,CAAtC,EAA0D;MACzDV,WAAW,GAAG,KAAd;IACA,CAFD,MAEO;MACNA,WAAW,GAAGV,GAAG,CAACE,GAAG,CAACoB,MAAM,CAACf,OAAO,CAACa,QAAT,CAAP,EAA2B,CAA3B,CAAJ,EAAmC,CAAnC,CAAjB;IACA;;IACD,IAAIV,WAAJ,EAAiB;MAChBC,gBAAgB,GAAG,EAAnB;MACAD,WAAW,GAAG,CAAC,IAAIA,WAAL,IAAoBL,MAAlC;MACAC,IAAI,CAACQ,EAAL,CAAQ,QAAQL,OAAhB,EAAyB,UAAUM,EAAV,EAAcQ,IAAd,EAAoBC,OAApB,EAA6B;QACrD,IAAI,CAACb,gBAAgB,CAACI,EAAD,CAArB,EAA2B;UAC1BJ,gBAAgB,CAACI,EAAD,CAAhB,GAAuB,UAAvB;UACAtB,QAAQ,CAAC,YAAY;YACpB,IAAIgC,MAAJ;YACA,IAAId,gBAAgB,CAACI,EAAD,CAAhB,KAAyB,UAA7B,EAAyC;YACzC,OAAOJ,gBAAgB,CAACI,EAAD,CAAvB;YACAT,IAAI,CAACW,MAAL,CAAYF,EAAZ;;YACA,IAAIR,OAAO,CAACK,KAAZ,EAAmB;cAClBW,IAAI,GAAGjC,KAAK,CAACiC,IAAD,CAAZ;cACAA,IAAI,CAACG,IAAL,CAAU7B,IAAV;YACA;;YACD4B,MAAM,GAAGnB,IAAI,CAACqB,QAAL,CAAcC,KAAd,CAAoBJ,OAApB,EAA6BD,IAA7B,CAAT;;YACA,IAAIhB,OAAO,CAACM,OAAZ,EAAqB;cACpB;cACA,IAAInB,SAAS,CAAC+B,MAAD,CAAb,EAAuB;gBACtB,IAAI,OAAOA,MAAM,CAACI,IAAd,KAAuB,UAA3B,EAAuCJ,MAAM,CAACI,IAAP,CAAYhC,IAAZ,EAAkBA,IAAlB,EAAvC,KACK4B,MAAM,CAACK,IAAP,CAAYjC,IAAZ,EAAkBA,IAAlB;cACL;YACD;UACD,CAjBO,CAAR;QAkBA;MACD,CAtBD;IAuBA;EACD;;EAEDS,IAAI,CAACQ,EAAL,CAAQ,UAAUL,OAAlB,EAA2B,YAAY;IACtCjB,OAAO,CAACgB,QAAD,EAAW,UAAUO,EAAV,EAAc;MAAEI,YAAY,CAACJ,EAAD,CAAZ;IAAmB,CAA9C,CAAP;IACAP,QAAQ,GAAG,EAAX;;IACA,IAAIG,gBAAJ,EAAsB;MACrBnB,OAAO,CAACmB,gBAAD,EAAmB,UAAUI,EAAV,EAAc;QAAE,IAAIA,EAAE,KAAK,UAAX,EAAuBI,YAAY,CAACJ,EAAD,CAAZ;MAAmB,CAA7E,CAAP;MACAJ,gBAAgB,GAAG,EAAnB;IACA;EACD,CAPD;AAQA,CA1ED"},"metadata":{},"sourceType":"script"}