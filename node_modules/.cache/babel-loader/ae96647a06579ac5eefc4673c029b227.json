{"ast":null,"code":"'use strict';\n\nconst dagPb = require('@ipld/dag-pb');\n\nconst {\n  sha256\n} = require('multiformats/hashes/sha2');\n\nconst {\n  UnixFS\n} = require('ipfs-unixfs');\n\nconst withTimeoutOption = require('ipfs-core-utils/src/with-timeout-option');\n\nconst {\n  CID\n} = require('multiformats/cid');\n/**\n * @param {Object} config\n * @param {import('ipfs-repo').IPFSRepo} config.repo\n * @param {import('../../types').Preload} config.preload\n */\n\n\nmodule.exports = _ref => {\n  let {\n    repo,\n    preload\n  } = _ref;\n\n  /**\n   * @type {import('ipfs-core-types/src/object').API[\"new\"]}\n   */\n  async function _new() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let data;\n\n    if (options.template) {\n      if (options.template === 'unixfs-dir') {\n        data = new UnixFS({\n          type: 'directory'\n        }).marshal();\n      } else {\n        throw new Error('unknown template');\n      }\n    }\n\n    const buf = dagPb.encode({\n      Data: data,\n      Links: []\n    });\n    const hash = await sha256.digest(buf);\n    const cid = CID.createV0(hash);\n    await repo.blocks.put(cid, buf, {\n      signal: options.signal\n    });\n\n    if (options.preload !== false) {\n      preload(cid);\n    }\n\n    return cid;\n  }\n\n  return withTimeoutOption(_new);\n};","map":{"version":3,"names":["dagPb","require","sha256","UnixFS","withTimeoutOption","CID","module","exports","repo","preload","_new","options","data","template","type","marshal","Error","buf","encode","Data","Links","hash","digest","cid","createV0","blocks","put","signal"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/ipfs-core/src/components/object/new.js"],"sourcesContent":["'use strict'\n\nconst dagPb = require('@ipld/dag-pb')\nconst { sha256 } = require('multiformats/hashes/sha2')\nconst { UnixFS } = require('ipfs-unixfs')\nconst withTimeoutOption = require('ipfs-core-utils/src/with-timeout-option')\nconst { CID } = require('multiformats/cid')\n\n/**\n * @param {Object} config\n * @param {import('ipfs-repo').IPFSRepo} config.repo\n * @param {import('../../types').Preload} config.preload\n */\nmodule.exports = ({ repo, preload }) => {\n  /**\n   * @type {import('ipfs-core-types/src/object').API[\"new\"]}\n   */\n  async function _new (options = {}) {\n    let data\n\n    if (options.template) {\n      if (options.template === 'unixfs-dir') {\n        data = (new UnixFS({ type: 'directory' })).marshal()\n      } else {\n        throw new Error('unknown template')\n      }\n    }\n\n    const buf = dagPb.encode({\n      Data: data,\n      Links: []\n    })\n    const hash = await sha256.digest(buf)\n    const cid = CID.createV0(hash)\n\n    await repo.blocks.put(cid, buf, {\n      signal: options.signal\n    })\n\n    if (options.preload !== false) {\n      preload(cid)\n    }\n\n    return cid\n  }\n\n  return withTimeoutOption(_new)\n}\n"],"mappings":"AAAA;;AAEA,MAAMA,KAAK,GAAGC,OAAO,CAAC,cAAD,CAArB;;AACA,MAAM;EAAEC;AAAF,IAAaD,OAAO,CAAC,0BAAD,CAA1B;;AACA,MAAM;EAAEE;AAAF,IAAaF,OAAO,CAAC,aAAD,CAA1B;;AACA,MAAMG,iBAAiB,GAAGH,OAAO,CAAC,yCAAD,CAAjC;;AACA,MAAM;EAAEI;AAAF,IAAUJ,OAAO,CAAC,kBAAD,CAAvB;AAEA;AACA;AACA;AACA;AACA;;;AACAK,MAAM,CAACC,OAAP,GAAiB,QAAuB;EAAA,IAAtB;IAAEC,IAAF;IAAQC;EAAR,CAAsB;;EACtC;AACF;AACA;EACE,eAAeC,IAAf,GAAmC;IAAA,IAAdC,OAAc,uEAAJ,EAAI;IACjC,IAAIC,IAAJ;;IAEA,IAAID,OAAO,CAACE,QAAZ,EAAsB;MACpB,IAAIF,OAAO,CAACE,QAAR,KAAqB,YAAzB,EAAuC;QACrCD,IAAI,GAAI,IAAIT,MAAJ,CAAW;UAAEW,IAAI,EAAE;QAAR,CAAX,CAAD,CAAoCC,OAApC,EAAP;MACD,CAFD,MAEO;QACL,MAAM,IAAIC,KAAJ,CAAU,kBAAV,CAAN;MACD;IACF;;IAED,MAAMC,GAAG,GAAGjB,KAAK,CAACkB,MAAN,CAAa;MACvBC,IAAI,EAAEP,IADiB;MAEvBQ,KAAK,EAAE;IAFgB,CAAb,CAAZ;IAIA,MAAMC,IAAI,GAAG,MAAMnB,MAAM,CAACoB,MAAP,CAAcL,GAAd,CAAnB;IACA,MAAMM,GAAG,GAAGlB,GAAG,CAACmB,QAAJ,CAAaH,IAAb,CAAZ;IAEA,MAAMb,IAAI,CAACiB,MAAL,CAAYC,GAAZ,CAAgBH,GAAhB,EAAqBN,GAArB,EAA0B;MAC9BU,MAAM,EAAEhB,OAAO,CAACgB;IADc,CAA1B,CAAN;;IAIA,IAAIhB,OAAO,CAACF,OAAR,KAAoB,KAAxB,EAA+B;MAC7BA,OAAO,CAACc,GAAD,CAAP;IACD;;IAED,OAAOA,GAAP;EACD;;EAED,OAAOnB,iBAAiB,CAACM,IAAD,CAAxB;AACD,CAlCD"},"metadata":{},"sourceType":"script"}