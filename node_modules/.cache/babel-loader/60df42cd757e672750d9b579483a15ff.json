{"ast":null,"code":"const FIFO = require('fast-fifo');\n\nmodule.exports = options => {\n  options = options || {};\n  let onEnd;\n\n  if (typeof options === 'function') {\n    onEnd = options;\n    options = {};\n  } else {\n    onEnd = options.onEnd;\n  }\n\n  let buffer = new FIFO();\n  let pushable, onNext, ended;\n\n  const waitNext = () => {\n    if (!buffer.isEmpty()) {\n      if (options.writev) {\n        let next;\n        const values = [];\n\n        while (!buffer.isEmpty()) {\n          next = buffer.shift();\n          if (next.error) throw next.error;\n          values.push(next.value);\n        }\n\n        return {\n          done: next.done,\n          value: values\n        };\n      }\n\n      const next = buffer.shift();\n      if (next.error) throw next.error;\n      return next;\n    }\n\n    if (ended) return {\n      done: true\n    };\n    return new Promise((resolve, reject) => {\n      onNext = next => {\n        onNext = null;\n\n        if (next.error) {\n          reject(next.error);\n        } else {\n          if (options.writev && !next.done) {\n            resolve({\n              done: next.done,\n              value: [next.value]\n            });\n          } else {\n            resolve(next);\n          }\n        }\n\n        return pushable;\n      };\n    });\n  };\n\n  const bufferNext = next => {\n    if (onNext) return onNext(next);\n    buffer.push(next);\n    return pushable;\n  };\n\n  const bufferError = err => {\n    buffer = new FIFO();\n    if (onNext) return onNext({\n      error: err\n    });\n    buffer.push({\n      error: err\n    });\n    return pushable;\n  };\n\n  const push = value => {\n    if (ended) return pushable;\n    return bufferNext({\n      done: false,\n      value\n    });\n  };\n\n  const end = err => {\n    if (ended) return pushable;\n    ended = true;\n    return err ? bufferError(err) : bufferNext({\n      done: true\n    });\n  };\n\n  const _return = () => {\n    buffer = new FIFO();\n    end();\n    return {\n      done: true\n    };\n  };\n\n  const _throw = err => {\n    end(err);\n    return {\n      done: true\n    };\n  };\n\n  pushable = {\n    [Symbol.asyncIterator]() {\n      return this;\n    },\n\n    next: waitNext,\n    return: _return,\n    throw: _throw,\n    push,\n    end\n  };\n  if (!onEnd) return pushable;\n  const _pushable = pushable;\n  pushable = {\n    [Symbol.asyncIterator]() {\n      return this;\n    },\n\n    next() {\n      return _pushable.next();\n    },\n\n    throw(err) {\n      _pushable.throw(err);\n\n      if (onEnd) {\n        onEnd(err);\n        onEnd = null;\n      }\n\n      return {\n        done: true\n      };\n    },\n\n    return() {\n      _pushable.return();\n\n      if (onEnd) {\n        onEnd();\n        onEnd = null;\n      }\n\n      return {\n        done: true\n      };\n    },\n\n    push,\n\n    end(err) {\n      _pushable.end(err);\n\n      if (onEnd) {\n        onEnd(err);\n        onEnd = null;\n      }\n\n      return pushable;\n    }\n\n  };\n  return pushable;\n};","map":{"version":3,"names":["FIFO","require","module","exports","options","onEnd","buffer","pushable","onNext","ended","waitNext","isEmpty","writev","next","values","shift","error","push","value","done","Promise","resolve","reject","bufferNext","bufferError","err","end","_return","_throw","Symbol","asyncIterator","return","throw","_pushable"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/it-pushable/index.js"],"sourcesContent":["const FIFO = require('fast-fifo')\n\nmodule.exports = (options) => {\n  options = options || {}\n  let onEnd\n\n  if (typeof options === 'function') {\n    onEnd = options\n    options = {}\n  } else {\n    onEnd = options.onEnd\n  }\n\n  let buffer = new FIFO()\n  let pushable, onNext, ended\n\n  const waitNext = () => {\n    if (!buffer.isEmpty()) {\n      if (options.writev) {\n        let next\n        const values = []\n        while (!buffer.isEmpty()) {\n          next = buffer.shift()\n          if (next.error) throw next.error\n          values.push(next.value)\n        }\n        return { done: next.done, value: values }\n      }\n\n      const next = buffer.shift()\n      if (next.error) throw next.error\n      return next\n    }\n\n    if (ended) return { done: true }\n\n    return new Promise((resolve, reject) => {\n      onNext = next => {\n        onNext = null\n        if (next.error) {\n          reject(next.error)\n        } else {\n          if (options.writev && !next.done) {\n            resolve({ done: next.done, value: [next.value] })\n          } else {\n            resolve(next)\n          }\n        }\n        return pushable\n      }\n    })\n  }\n\n  const bufferNext = next => {\n    if (onNext) return onNext(next)\n    buffer.push(next)\n    return pushable\n  }\n\n  const bufferError = err => {\n    buffer = new FIFO()\n    if (onNext) return onNext({ error: err })\n    buffer.push({ error: err })\n    return pushable\n  }\n\n  const push = value => {\n    if (ended) return pushable\n    return bufferNext({ done: false, value })\n  }\n  const end = err => {\n    if (ended) return pushable\n    ended = true\n    return err ? bufferError(err) : bufferNext({ done: true })\n  }\n  const _return = () => {\n    buffer = new FIFO()\n    end()\n    return { done: true }\n  }\n  const _throw = err => {\n    end(err)\n    return { done: true }\n  }\n\n  pushable = {\n    [Symbol.asyncIterator] () { return this },\n    next: waitNext,\n    return: _return,\n    throw: _throw,\n    push,\n    end\n  }\n\n  if (!onEnd) return pushable\n\n  const _pushable = pushable\n\n  pushable = {\n    [Symbol.asyncIterator] () { return this },\n    next () {\n      return _pushable.next()\n    },\n    throw (err) {\n      _pushable.throw(err)\n      if (onEnd) {\n        onEnd(err)\n        onEnd = null\n      }\n      return { done: true }\n    },\n    return () {\n      _pushable.return()\n      if (onEnd) {\n        onEnd()\n        onEnd = null\n      }\n      return { done: true }\n    },\n    push,\n    end (err) {\n      _pushable.end(err)\n      if (onEnd) {\n        onEnd(err)\n        onEnd = null\n      }\n      return pushable\n    }\n  }\n\n  return pushable\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}