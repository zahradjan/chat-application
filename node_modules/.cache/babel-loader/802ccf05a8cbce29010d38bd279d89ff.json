{"ast":null,"code":"'use strict';\n\nvar _regeneratorRuntime = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\n\nvar _asyncToGenerator = require(\"C:/Users/zajan/GitHub/chatApplication/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\n\nvar _require = require('uint8arrays/equals'),\n    uint8ArrayEquals = _require.equals;\n\nvar Message = require('../../message');\n\nvar utils = require('../../utils');\n/**\n * @typedef {import('peer-id')} PeerId\n */\n\n/**\n * @param {import('../../index')} dht\n */\n\n\nmodule.exports = function (dht) {\n  var log = utils.logger(dht.peerId, 'rpc:find-node');\n  /**\n   * Process `FindNode` DHT messages.\n   *\n   * @param {PeerId} peerId\n   * @param {Message} msg\n   */\n\n  function findNode(_x, _x2) {\n    return _findNode.apply(this, arguments);\n  }\n\n  function _findNode() {\n    _findNode = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(peerId, msg) {\n      var closer, response;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              log('start');\n\n              if (!uint8ArrayEquals(msg.key, dht.peerId.id)) {\n                _context.next = 5;\n                break;\n              }\n\n              closer = [{\n                id: dht.peerId,\n                multiaddrs: dht.libp2p.multiaddrs\n              }];\n              _context.next = 8;\n              break;\n\n            case 5:\n              _context.next = 7;\n              return dht._betterPeersToQuery(msg, peerId);\n\n            case 7:\n              closer = _context.sent;\n\n            case 8:\n              response = new Message(msg.type, new Uint8Array(0), msg.clusterLevel);\n\n              if (closer.length > 0) {\n                response.closerPeers = closer;\n              } else {\n                log('handle FindNode %s: could not find anything', peerId.toB58String());\n              }\n\n              return _context.abrupt(\"return\", response);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _findNode.apply(this, arguments);\n  }\n\n  return findNode;\n};","map":{"version":3,"names":["require","uint8ArrayEquals","equals","Message","utils","module","exports","dht","log","logger","peerId","findNode","msg","key","id","closer","multiaddrs","libp2p","_betterPeersToQuery","response","type","Uint8Array","clusterLevel","length","closerPeers","toB58String"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/libp2p-kad-dht/src/rpc/handlers/find-node.js"],"sourcesContent":["'use strict'\n\nconst { equals: uint8ArrayEquals } = require('uint8arrays/equals')\n\nconst Message = require('../../message')\nconst utils = require('../../utils')\n\n/**\n * @typedef {import('peer-id')} PeerId\n */\n\n/**\n * @param {import('../../index')} dht\n */\nmodule.exports = (dht) => {\n  const log = utils.logger(dht.peerId, 'rpc:find-node')\n\n  /**\n   * Process `FindNode` DHT messages.\n   *\n   * @param {PeerId} peerId\n   * @param {Message} msg\n   */\n  async function findNode (peerId, msg) {\n    log('start')\n\n    let closer\n    if (uint8ArrayEquals(msg.key, dht.peerId.id)) {\n      closer = [{\n        id: dht.peerId,\n        multiaddrs: dht.libp2p.multiaddrs\n      }]\n    } else {\n      closer = await dht._betterPeersToQuery(msg, peerId)\n    }\n\n    const response = new Message(msg.type, new Uint8Array(0), msg.clusterLevel)\n\n    if (closer.length > 0) {\n      response.closerPeers = closer\n    } else {\n      log('handle FindNode %s: could not find anything', peerId.toB58String())\n    }\n\n    return response\n  }\n\n  return findNode\n}\n"],"mappings":"AAAA;;;;;;AAEA,eAAqCA,OAAO,CAAC,oBAAD,CAA5C;AAAA,IAAgBC,gBAAhB,YAAQC,MAAR;;AAEA,IAAMC,OAAO,GAAGH,OAAO,CAAC,eAAD,CAAvB;;AACA,IAAMI,KAAK,GAAGJ,OAAO,CAAC,aAAD,CAArB;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AACAK,MAAM,CAACC,OAAP,GAAiB,UAACC,GAAD,EAAS;EACxB,IAAMC,GAAG,GAAGJ,KAAK,CAACK,MAAN,CAAaF,GAAG,CAACG,MAAjB,EAAyB,eAAzB,CAAZ;EAEA;AACF;AACA;AACA;AACA;AACA;;EAR0B,SASTC,QATS;IAAA;EAAA;;EAAA;IAAA,uEASxB,iBAAyBD,MAAzB,EAAiCE,GAAjC;MAAA;MAAA;QAAA;UAAA;YAAA;cACEJ,GAAG,CAAC,OAAD,CAAH;;cADF,KAIMP,gBAAgB,CAACW,GAAG,CAACC,GAAL,EAAUN,GAAG,CAACG,MAAJ,CAAWI,EAArB,CAJtB;gBAAA;gBAAA;cAAA;;cAKIC,MAAM,GAAG,CAAC;gBACRD,EAAE,EAAEP,GAAG,CAACG,MADA;gBAERM,UAAU,EAAET,GAAG,CAACU,MAAJ,CAAWD;cAFf,CAAD,CAAT;cALJ;cAAA;;YAAA;cAAA;cAAA,OAUmBT,GAAG,CAACW,mBAAJ,CAAwBN,GAAxB,EAA6BF,MAA7B,CAVnB;;YAAA;cAUIK,MAVJ;;YAAA;cAaQI,QAbR,GAamB,IAAIhB,OAAJ,CAAYS,GAAG,CAACQ,IAAhB,EAAsB,IAAIC,UAAJ,CAAe,CAAf,CAAtB,EAAyCT,GAAG,CAACU,YAA7C,CAbnB;;cAeE,IAAIP,MAAM,CAACQ,MAAP,GAAgB,CAApB,EAAuB;gBACrBJ,QAAQ,CAACK,WAAT,GAAuBT,MAAvB;cACD,CAFD,MAEO;gBACLP,GAAG,CAAC,6CAAD,EAAgDE,MAAM,CAACe,WAAP,EAAhD,CAAH;cACD;;cAnBH,iCAqBSN,QArBT;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CATwB;IAAA;EAAA;;EAiCxB,OAAOR,QAAP;AACD,CAlCD"},"metadata":{},"sourceType":"script"}