{"ast":null,"code":"'use strict';\n\nconst {\n  Buffer\n} = require('buffer');\n\nvar defined = require('./utils').defined;\n\nvar varint = require('varint');\n\nfunction compileEncode(m, resolve, enc, oneofs, encodingLength) {\n  var oneofsKeys = Object.keys(oneofs);\n  var encLength = enc.length;\n  var ints = {};\n\n  for (var i = 0; i < encLength; i++) {\n    ints[i] = {\n      p: varint.encode(m.fields[i].tag << 3 | 2),\n      h: varint.encode(m.fields[i].tag << 3 | enc[i].type)\n    };\n    var field = m.fields[i];\n    m.fields[i].packed = field.repeated && field.options && field.options.packed && field.options.packed !== 'false';\n  }\n\n  function encodeField(buf, offset, h, e, packed, innerVal) {\n    var j = 0;\n\n    if (!packed) {\n      for (j = 0; j < h.length; j++) {\n        buf[offset++] = h[j];\n      }\n    }\n\n    if (e.message) {\n      varint.encode(e.encodingLength(innerVal), buf, offset);\n      offset += varint.encode.bytes;\n    }\n\n    e.encode(innerVal, buf, offset);\n    return offset + e.encode.bytes;\n  }\n\n  return function encode(obj, buf, offset) {\n    if (offset == null) {\n      offset = 0;\n    }\n\n    if (buf == null) {\n      buf = Buffer.allocUnsafe(encodingLength(obj));\n    }\n\n    var oldOffset = offset;\n    var objKeys = Object.keys(obj);\n    var i = 0; // oneof checks\n\n    var match = false;\n\n    for (i = 0; i < oneofsKeys.length; i++) {\n      var name = oneofsKeys[i];\n      var prop = oneofs[i];\n\n      if (objKeys.indexOf(prop) > -1) {\n        if (match) {\n          throw new Error('only one of the properties defined in oneof ' + name + ' can be set');\n        }\n\n        match = true;\n      }\n    }\n\n    for (i = 0; i < encLength; i++) {\n      var e = enc[i];\n      var field = m.fields[i]; // was f\n\n      var val = obj[field.name];\n      var j = 0;\n\n      if (!defined(val)) {\n        if (field.required) {\n          throw new Error(field.name + ' is required');\n        }\n\n        continue;\n      }\n\n      var p = ints[i].p;\n      var h = ints[i].h;\n      var packed = field.packed;\n\n      if (field.map) {\n        var tmp = Object.keys(val);\n\n        for (j = 0; j < tmp.length; j++) {\n          tmp[j] = {\n            key: tmp[j],\n            value: val[tmp[j]]\n          };\n        }\n\n        val = tmp;\n      }\n\n      if (packed) {\n        var packedLen = 0;\n\n        for (j = 0; j < val.length; j++) {\n          if (!Object.prototype.hasOwnProperty.call(val, j)) {\n            continue;\n          }\n\n          packedLen += e.encodingLength(val[j]);\n        }\n\n        if (packedLen) {\n          for (j = 0; j < h.length; j++) {\n            buf[offset++] = p[j];\n          }\n\n          varint.encode(packedLen, buf, offset);\n          offset += varint.encode.bytes;\n        }\n      }\n\n      if (field.repeated) {\n        var innerVal;\n\n        for (j = 0; j < val.length; j++) {\n          innerVal = val[j];\n\n          if (!defined(innerVal)) {\n            continue;\n          }\n\n          offset = encodeField(buf, offset, h, e, packed, innerVal);\n        }\n      } else {\n        offset = encodeField(buf, offset, h, e, packed, val);\n      }\n    }\n\n    encode.bytes = offset - oldOffset;\n    return buf;\n  };\n}\n\nmodule.exports = compileEncode;","map":{"version":3,"names":["Buffer","require","defined","varint","compileEncode","m","resolve","enc","oneofs","encodingLength","oneofsKeys","Object","keys","encLength","length","ints","i","p","encode","fields","tag","h","type","field","packed","repeated","options","encodeField","buf","offset","e","innerVal","j","message","bytes","obj","allocUnsafe","oldOffset","objKeys","match","name","prop","indexOf","Error","val","required","map","tmp","key","value","packedLen","prototype","hasOwnProperty","call","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/protons/src/compile/encode.js"],"sourcesContent":["'use strict'\nconst { Buffer } = require('buffer')\nvar defined = require('./utils').defined\nvar varint = require('varint')\n\nfunction compileEncode (m, resolve, enc, oneofs, encodingLength) {\n  var oneofsKeys = Object.keys(oneofs)\n  var encLength = enc.length\n  var ints = {}\n  for (var i = 0; i < encLength; i++) {\n    ints[i] = {\n      p: varint.encode(m.fields[i].tag << 3 | 2),\n      h: varint.encode(m.fields[i].tag << 3 | enc[i].type)\n    }\n\n    var field = m.fields[i]\n    m.fields[i].packed = field.repeated && field.options && field.options.packed && field.options.packed !== 'false'\n  }\n\n  function encodeField (buf, offset, h, e, packed, innerVal) {\n    var j = 0\n    if (!packed) {\n      for (j = 0; j < h.length; j++) {\n        buf[offset++] = h[j]\n      }\n    }\n\n    if (e.message) {\n      varint.encode(e.encodingLength(innerVal), buf, offset)\n      offset += varint.encode.bytes\n    }\n\n    e.encode(innerVal, buf, offset)\n    return offset + e.encode.bytes\n  }\n\n  return function encode (obj, buf, offset) {\n    if (offset == null) {\n      offset = 0\n    }\n    if (buf == null) {\n      buf = Buffer.allocUnsafe(encodingLength(obj))\n    }\n\n    var oldOffset = offset\n    var objKeys = Object.keys(obj)\n    var i = 0\n\n    // oneof checks\n\n    var match = false\n    for (i = 0; i < oneofsKeys.length; i++) {\n      var name = oneofsKeys[i]\n      var prop = oneofs[i]\n      if (objKeys.indexOf(prop) > -1) {\n        if (match) {\n          throw new Error('only one of the properties defined in oneof ' + name + ' can be set')\n        }\n\n        match = true\n      }\n    }\n\n    for (i = 0; i < encLength; i++) {\n      var e = enc[i]\n      var field = m.fields[i] // was f\n      var val = obj[field.name]\n      var j = 0\n\n      if (!defined(val)) {\n        if (field.required) {\n          throw new Error(field.name + ' is required')\n        }\n        continue\n      }\n      var p = ints[i].p\n      var h = ints[i].h\n\n      var packed = field.packed\n\n      if (field.map) {\n        var tmp = Object.keys(val)\n        for (j = 0; j < tmp.length; j++) {\n          tmp[j] = {\n            key: tmp[j],\n            value: val[tmp[j]]\n          }\n        }\n        val = tmp\n      }\n\n      if (packed) {\n        var packedLen = 0\n        for (j = 0; j < val.length; j++) {\n          if (!Object.prototype.hasOwnProperty.call(val, j)) {\n            continue\n          }\n\n          packedLen += e.encodingLength(val[j])\n        }\n\n        if (packedLen) {\n          for (j = 0; j < h.length; j++) {\n            buf[offset++] = p[j]\n          }\n          varint.encode(packedLen, buf, offset)\n          offset += varint.encode.bytes\n        }\n      }\n\n      if (field.repeated) {\n        var innerVal\n        for (j = 0; j < val.length; j++) {\n          innerVal = val[j]\n          if (!defined(innerVal)) {\n            continue\n          }\n          offset = encodeField(buf, offset, h, e, packed, innerVal)\n        }\n      } else {\n        offset = encodeField(buf, offset, h, e, packed, val)\n      }\n    }\n\n    encode.bytes = offset - oldOffset\n    return buf\n  }\n}\n\nmodule.exports = compileEncode\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}