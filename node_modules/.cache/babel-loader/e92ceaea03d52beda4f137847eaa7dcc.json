{"ast":null,"code":"'use strict';\n\nconst {\n  pullAt,\n  cloneDeep\n} = require('lodash');\n\nconst debug = require('debug-logfmt')('hyperdiff');\n\nconst isPresent = itemIndex => itemIndex !== -1;\n\nfunction GET_INITIAL_STATE() {\n  return {\n    common: [],\n    removed: []\n  };\n}\n\nfunction hasItemWithProps(collection, item, props) {\n  return props.every(prop => item[prop] === collection[prop]);\n}\n\nfunction indexOf(collection, item) {\n  return collection.indexOf(item);\n}\n\nfunction findIndexWithProps(collection, item, props) {\n  return collection.findIndex(function (origItem) {\n    return hasItemWithProps(origItem, item, props);\n  });\n}\n\nfunction determinateCollections(orig, dist) {\n  return {\n    first: orig,\n    second: cloneDeep(dist)\n  };\n}\n\nfunction determinateFindIndex(ids, props) {\n  return props ? findIndexWithProps : indexOf;\n}\n\nfunction hyperdiff(orig, dist, props) {\n  const ids = props ? [].concat(props) : [];\n  const {\n    first,\n    second\n  } = determinateCollections(orig, dist);\n  const findIndex = determinateFindIndex(ids, props);\n  debug(`preconditions first=${JSON.stringify(first)} second=${JSON.stringify(second)} findIndex=${findIndex.name}`);\n  const results = first.reduce(function (acc, item, index) {\n    const itemIndex = findIndex(second, item, ids);\n    const destination = isPresent(itemIndex) ? 'common' : 'removed';\n    acc[destination].push(item);\n    pullAt(second, itemIndex);\n    debug(`index=${index} value=${JSON.stringify(item)} collection=${destination}`);\n    return acc;\n  }, GET_INITIAL_STATE());\n  results.added = second;\n  debug(`added=${JSON.stringify(results.added)} removed=${JSON.stringify(results.removed)} common=${JSON.stringify(results.common)}`);\n  return results;\n}\n\nmodule.exports = hyperdiff;","map":{"version":3,"names":["pullAt","cloneDeep","require","debug","isPresent","itemIndex","GET_INITIAL_STATE","common","removed","hasItemWithProps","collection","item","props","every","prop","indexOf","findIndexWithProps","findIndex","origItem","determinateCollections","orig","dist","first","second","determinateFindIndex","ids","hyperdiff","concat","JSON","stringify","name","results","reduce","acc","index","destination","push","added","module","exports"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/hyperdiff/src/index.js"],"sourcesContent":["'use strict'\n\nconst { pullAt, cloneDeep } = require('lodash')\nconst debug = require('debug-logfmt')('hyperdiff')\n\nconst isPresent = itemIndex => itemIndex !== -1\n\nfunction GET_INITIAL_STATE () {\n  return { common: [], removed: [] }\n}\n\nfunction hasItemWithProps (collection, item, props) {\n  return props.every(prop => item[prop] === collection[prop])\n}\n\nfunction indexOf (collection, item) {\n  return collection.indexOf(item)\n}\n\nfunction findIndexWithProps (collection, item, props) {\n  return collection.findIndex(function (origItem) {\n    return hasItemWithProps(origItem, item, props)\n  })\n}\n\nfunction determinateCollections (orig, dist) {\n  return { first: orig, second: cloneDeep(dist) }\n}\n\nfunction determinateFindIndex (ids, props) {\n  return props ? findIndexWithProps : indexOf\n}\n\nfunction hyperdiff (orig, dist, props) {\n  const ids = props ? [].concat(props) : []\n  const { first, second } = determinateCollections(orig, dist)\n  const findIndex = determinateFindIndex(ids, props)\n\n  debug(\n    `preconditions first=${JSON.stringify(first)} second=${JSON.stringify(second)} findIndex=${\n      findIndex.name\n    }`\n  )\n\n  const results = first.reduce(function (acc, item, index) {\n    const itemIndex = findIndex(second, item, ids)\n    const destination = isPresent(itemIndex) ? 'common' : 'removed'\n    acc[destination].push(item)\n    pullAt(second, itemIndex)\n    debug(`index=${index} value=${JSON.stringify(item)} collection=${destination}`)\n    return acc\n  }, GET_INITIAL_STATE())\n\n  results.added = second\n  debug(\n    `added=${JSON.stringify(results.added)} removed=${JSON.stringify(\n      results.removed\n    )} common=${JSON.stringify(results.common)}`\n  )\n  return results\n}\n\nmodule.exports = hyperdiff\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}