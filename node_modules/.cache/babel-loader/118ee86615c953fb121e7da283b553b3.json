{"ast":null,"code":"'use strict';\n\nvar throttle = require('lodash.throttle');\n\nexports = module.exports = TimeCache;\n\nfunction TimeCache(options) {\n  var _this = this;\n\n  if (!(this instanceof TimeCache)) {\n    return new TimeCache(options);\n  }\n\n  options = options || {};\n  var validity = options.validity || 30; // seconds\n\n  var entries = new Map();\n  var sweep = throttle(function () {\n    entries.forEach(function (entry, key) {\n      var v = entry.validity || validity;\n      var delta = getTimeElapsed(entry.timestamp);\n\n      if (delta > v) {\n        entries.delete(key);\n      }\n    });\n  }, 200);\n\n  this.put = function (key, value, validity) {\n    if (!_this.has(key)) {\n      entries.set(key, {\n        value: value,\n        timestamp: new Date(),\n        validity: validity\n      });\n    }\n\n    sweep();\n  };\n\n  this.get = function (key) {\n    if (entries.has(key)) {\n      return entries.get(key).value;\n    } else {\n      throw new Error('key does not exist');\n    }\n  };\n\n  this.has = function (key) {\n    return entries.has(key);\n  };\n}\n\nfunction getTimeElapsed(prevTime) {\n  var currentTime = new Date();\n  var a = currentTime.getTime() - prevTime.getTime();\n  return Math.floor(a / 1000);\n}","map":{"version":3,"names":["throttle","require","exports","module","TimeCache","options","validity","entries","Map","sweep","forEach","entry","key","v","delta","getTimeElapsed","timestamp","delete","put","value","has","set","Date","get","Error","prevTime","currentTime","a","getTime","Math","floor"],"sources":["C:/Users/zajan/GitHub/chatApplication/node_modules/time-cache/src/index.js"],"sourcesContent":["'use strict'\n\nconst throttle = require('lodash.throttle')\nexports = module.exports = TimeCache\n\nfunction TimeCache (options) {\n  if (!(this instanceof TimeCache)) {\n    return new TimeCache(options)\n  }\n\n  options = options || {}\n\n  const validity = options.validity || 30 // seconds\n\n  const entries = new Map()\n\n  const sweep = throttle(() => {\n    entries.forEach((entry, key) => {\n      const v = entry.validity || validity\n      const delta = getTimeElapsed(entry.timestamp)\n      if (delta > v) {\n        entries.delete(key)\n      }\n    })\n  }, 200)\n\n  this.put = (key, value, validity) => {\n    if (!this.has(key)) {\n      entries.set(key, {\n        value: value,\n        timestamp: new Date(),\n        validity: validity\n      })\n    }\n\n    sweep()\n  }\n\n  this.get = (key) => {\n    if (entries.has(key)) {\n      return entries.get(key).value\n    } else {\n      throw new Error('key does not exist')\n    }\n  }\n\n  this.has = (key) => {\n    return entries.has(key)\n  }\n}\n\nfunction getTimeElapsed (prevTime) {\n  const currentTime = new Date()\n  const a = currentTime.getTime() - prevTime.getTime()\n\n  return Math.floor(a / 1000)\n}\n"],"mappings":"AAAA;;AAEA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,iBAAD,CAAxB;;AACAC,OAAO,GAAGC,MAAM,CAACD,OAAP,GAAiBE,SAA3B;;AAEA,SAASA,SAAT,CAAoBC,OAApB,EAA6B;EAAA;;EAC3B,IAAI,EAAE,gBAAgBD,SAAlB,CAAJ,EAAkC;IAChC,OAAO,IAAIA,SAAJ,CAAcC,OAAd,CAAP;EACD;;EAEDA,OAAO,GAAGA,OAAO,IAAI,EAArB;EAEA,IAAMC,QAAQ,GAAGD,OAAO,CAACC,QAAR,IAAoB,EAArC,CAP2B,CAOa;;EAExC,IAAMC,OAAO,GAAG,IAAIC,GAAJ,EAAhB;EAEA,IAAMC,KAAK,GAAGT,QAAQ,CAAC,YAAM;IAC3BO,OAAO,CAACG,OAAR,CAAgB,UAACC,KAAD,EAAQC,GAAR,EAAgB;MAC9B,IAAMC,CAAC,GAAGF,KAAK,CAACL,QAAN,IAAkBA,QAA5B;MACA,IAAMQ,KAAK,GAAGC,cAAc,CAACJ,KAAK,CAACK,SAAP,CAA5B;;MACA,IAAIF,KAAK,GAAGD,CAAZ,EAAe;QACbN,OAAO,CAACU,MAAR,CAAeL,GAAf;MACD;IACF,CAND;EAOD,CARqB,EAQnB,GARmB,CAAtB;;EAUA,KAAKM,GAAL,GAAW,UAACN,GAAD,EAAMO,KAAN,EAAab,QAAb,EAA0B;IACnC,IAAI,CAAC,KAAI,CAACc,GAAL,CAASR,GAAT,CAAL,EAAoB;MAClBL,OAAO,CAACc,GAAR,CAAYT,GAAZ,EAAiB;QACfO,KAAK,EAAEA,KADQ;QAEfH,SAAS,EAAE,IAAIM,IAAJ,EAFI;QAGfhB,QAAQ,EAAEA;MAHK,CAAjB;IAKD;;IAEDG,KAAK;EACN,CAVD;;EAYA,KAAKc,GAAL,GAAW,UAACX,GAAD,EAAS;IAClB,IAAIL,OAAO,CAACa,GAAR,CAAYR,GAAZ,CAAJ,EAAsB;MACpB,OAAOL,OAAO,CAACgB,GAAR,CAAYX,GAAZ,EAAiBO,KAAxB;IACD,CAFD,MAEO;MACL,MAAM,IAAIK,KAAJ,CAAU,oBAAV,CAAN;IACD;EACF,CAND;;EAQA,KAAKJ,GAAL,GAAW,UAACR,GAAD,EAAS;IAClB,OAAOL,OAAO,CAACa,GAAR,CAAYR,GAAZ,CAAP;EACD,CAFD;AAGD;;AAED,SAASG,cAAT,CAAyBU,QAAzB,EAAmC;EACjC,IAAMC,WAAW,GAAG,IAAIJ,IAAJ,EAApB;EACA,IAAMK,CAAC,GAAGD,WAAW,CAACE,OAAZ,KAAwBH,QAAQ,CAACG,OAAT,EAAlC;EAEA,OAAOC,IAAI,CAACC,KAAL,CAAWH,CAAC,GAAG,IAAf,CAAP;AACD"},"metadata":{},"sourceType":"script"}